{"id": "batch_req_693199151458819081adee5f04d66857", "custom_id": "example::complex-analysis::extreme-stationary-and-saddle-point-methods::1", "response": {"status_code": 200, "request_id": "6725349e0d6e6c6d7dce4e5d8e7cbff8", "body": {"id": "resp_0688d81af2c7ba010069319772d3d88197a81f908bd40130cc", "object": "response", "created_at": 1764857714, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0688d81af2c7ba01006931977348fc8197bdf8927a8bc5903e", "type": "reasoning", "summary": []}, {"id": "msg_0688d81af2c7ba010069319779bf7c8197a640e07457f66145", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "\\[\n\\begin{aligned}\nG(\\lambda)\n&= \\frac{1}{\\sqrt{\\lambda|\\alpha|}}\n\\int_{-\\infty}^{\\infty} e^{i\\,\\operatorname{sgn}(\\alpha)\\,y^2/2}\\,dy.\n\\end{aligned}\n\\]\nUsing the standard Fresnel-type integral\n\\[\n\\int_{-\\infty}^{\\infty} e^{i y^2/2}\\,dy = e^{i\\pi/4}\\sqrt{2\\pi},\n\\]\nwe obtain\n\\[\n\\int_{-\\infty}^{\\infty} e^{i\\,\\operatorname{sgn}(\\alpha)\\,y^2/2}\\,dy\n= e^{i\\frac{\\pi}{4}\\operatorname{sgn}(\\alpha)}\\sqrt{2\\pi}.\n\\]\nTherefore\n\\[\nG(\\lambda)\n= e^{i\\frac{\\pi}{4}\\operatorname{sgn}(\\alpha)}\\sqrt{\\frac{2\\pi}{\\lambda|\\alpha|}}\n= e^{i\\frac{\\pi}{4}\\operatorname{sgn}(\\phi''(x_0))}\n\\sqrt{\\frac{2\\pi}{\\lambda\\,|\\phi''(x_0)|}}.\n\\]\n\nRecalling that $I_{\\mathrm{near}}(\\lambda)\n= e^{i\\lambda\\phi(x_0)}a(x_0)G(\\lambda)$ up to an error of order $\\mathcal{O}(\\lambda^{-3/2})$ (coming from the $(x-x_0)a_1(x)$ term and from replacing $R_3(x)$ and $\\chi(x)$ by $0$ and $1$, respectively), we conclude\n\\[\nI_{\\mathrm{near}}(\\lambda)\n= e^{i\\lambda\\phi(x_0)}a(x_0)\\,\ne^{i\\frac{\\pi}{4}\\operatorname{sgn}(\\phi''(x_0))}\n\\sqrt{\\frac{2\\pi}{\\lambda\\,|\\phi''(x_0)|}}\n\\;+\\;\\mathcal{O}\\!\\left(\\lambda^{-3/2}\\right).\n\\]\n\n\\medskip\n\n\\textbf{5. Combination of near and far contributions.}\nWe have shown that\n\\[\nI(\\lambda) = I_{\\mathrm{near}}(\\lambda) + I_{\\mathrm{far}}(\\lambda),\n\\]\nwith\n\\[\nI_{\\mathrm{near}}(\\lambda)\n= e^{i\\lambda\\phi(x_0)}a(x_0)\\,\ne^{i\\frac{\\pi}{4}\\operatorname{sgn}(\\phi''(x_0))}\n\\sqrt{\\frac{2\\pi}{\\lambda\\,|\\phi''(x_0)|}}\n\\;+\\;\\mathcal{O}\\!\\left(\\lambda^{-3/2}\\right),\n\\]\nand $I_{\\mathrm{far}}(\\lambda)$ decaying faster than any power of $\\lambda^{-1}$ by iterated integration by parts. In particular, $I_{\\mathrm{far}}(\\lambda)=\\mathcal{O}(\\lambda^{-2})$, which is certainly $\\mathcal{O}(\\lambda^{-3/2})$.\n\nHence\n\\[\nI(\\lambda)\n= e^{i\\lambda\\phi(x_0)}a(x_0)\\,\ne^{i\\frac{\\pi}{4}\\operatorname{sgn}(\\phi''(x_0))}\n\\sqrt{\\frac{2\\pi}{\\lambda\\,|\\phi''(x_0)|}}\n\\;+\\;\\mathcal{O}\\!\\left(\\lambda^{-3/2}\\right),\n\\quad \\lambda\\to\\infty.\n\\]\n\nThis establishes the stated stationary phase asymptotic. The leading term depends only on the value of the amplitude $a$ and the quadratic behavior of the phase $\\phi$ at the stationary point $x_0$, while the contribution from regions where the phase is nonstationary is suppressed by rapid oscillations and integration by parts, and thus contributes only to lower-order terms in $\\lambda^{-1}$.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 5795, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 1758, "output_tokens_details": {"reasoning_tokens": 865}, "total_tokens": 7553}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199155ff481909991ee6f700a24e8", "custom_id": "example::complex-analysis::extreme-stationary-and-saddle-point-methods::2", "response": {"status_code": 200, "request_id": "6264b1a0ed86c2112d63dd2a00981700", "body": {"id": "resp_0d728b654de1a0450069319781c1d081959dc2ef52830ee64c", "object": "response", "created_at": 1764857729, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0d728b654de1a0450069319781f8e8819595773e49399ff1fc", "type": "reasoning", "summary": []}, {"id": "msg_0d728b654de1a045006931979687748195820a3b1cb6f9fbf1", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "As $t$ runs from $-\\infty$ to $\\infty$, $z(t)$ runs along the entire line $y=x$.\n\nAlong this contour,\n\\[\nz(t)^2 = e^{i\\pi/2}\\,t^2 = i t^2,\n\\]\nso\n\\[\ni\\lambda z(t)^2 = i\\lambda\\,(i t^2) = -\\lambda t^2,\n\\]\nand therefore\n\\[\ne^{i\\lambda z(t)^2} = e^{-\\lambda t^2},\\qquad t\\in\\mathbb{R}.\n\\]\nThus the integrand decays like a Gaussian away from the saddle along the steepest descent line.\n\nMoreover\n\\[\ndz = z'(t)\\,dt = e^{i\\pi/4}\\,dt,\n\\]\nso the integral along the steepest descent contour $\\Gamma_{\\mathrm{sd}}$ is\n\\[\n\\int_{\\Gamma_{\\mathrm{sd}}} e^{i\\lambda z^2}\\,dz\n=\n\\int_{-\\infty}^\\infty e^{i\\lambda z(t)^2}\\,z'(t)\\,dt\n=\ne^{i\\pi/4}\\int_{-\\infty}^\\infty e^{-\\lambda t^2}\\,dt.\n\\]\nUsing the standard Gaussian integral,\n\\[\n\\int_{-\\infty}^\\infty e^{-\\lambda t^2}\\,dt = \\sqrt{\\frac{\\pi}{\\lambda}},\n\\]\nwe obtain\n\\[\n\\int_{\\Gamma_{\\mathrm{sd}}} e^{i\\lambda z^2}\\,dz\n=\ne^{i\\pi/4}\\sqrt{\\frac{\\pi}{\\lambda}}.\n\\]\n\n\\medskip\n\n\\textbf{3. Deforming the real axis to the steepest descent contour.}\n\nTo justify replacing the original real-axis contour by $\\Gamma_{\\mathrm{sd}}$, consider for $R>0$ the contour $\\mathcal{C}_R$ consisting of four pieces:\n\n\\begin{itemize}\n\\item the real segment $\\gamma_1$: $[-R,R]\\subset\\mathbb{R}$;\n\\item the segment $\\gamma_2$ along the ray at angle $\\pi/4$ from $R$ to $Re^{i\\pi/4}$;\n\\item the segment $\\gamma_3$ along the steepest descent line from $Re^{i\\pi/4}$ to $-Re^{i\\pi/4}$ (this is part of $\\Gamma_{\\mathrm{sd}}$);\n\\item the segment $\\gamma_4$ along the ray at angle $\\pi/4$ from $-Re^{i\\pi/4}$ back to $-R$.\n\\end{itemize}\n\nThe function $e^{i\\lambda z^2}$ is entire, so by Cauchy's theorem the integral of $e^{i\\lambda z^2}$ around the closed contour $\\mathcal{C}_R$ is zero:\n\\[\n\\int_{\\gamma_1} e^{i\\lambda z^2}\\,dz\n+\n\\int_{\\gamma_2} e^{i\\lambda z^2}\\,dz\n+\n\\int_{\\gamma_3} e^{i\\lambda z^2}\\,dz\n+\n\\int_{\\gamma_4} e^{i\\lambda z^2}\\,dz\n=0.\n\\]\nRearranging,\n\\[\n\\int_{-R}^R e^{i\\lambda x^2}\\,dx\n=\n-\\int_{\\gamma_2} e^{i\\lambda z^2}\\,dz\n-\\int_{\\gamma_4} e^{i\\lambda z^2}\\,dz\n-\\int_{\\gamma_3} e^{i\\lambda z^2}\\,dz.\n\\]\n\nWe now estimate the contributions from $\\gamma_2$ and $\\gamma_4$ as $R\\to\\infty$.  On each of these rays we have $z=\\rho e^{i\\pi/4}$ with $\\rho$ ranging over an interval of the form $[\\rho_0,R]$ and $\\rho_0$ independent of $R$; hence\n\\[\ni\\lambda z^2\n=\ni\\lambda \\rho^2 e^{i\\pi/2}\n=\ni\\lambda \\rho^2 (i)\n=\n-\\lambda\\rho^2,\n\\]\nso\n\\[\n\\left|e^{i\\lambda z^2}\\right|\n=\ne^{-\\lambda\\rho^2}.\n\\]\nThe length of each ray segment is $O(R)$, while the integrand is bounded by $e^{-\\lambda\\rho^2}$ with $\\rho\\ge\\rho_0$. Thus\n\\[\n\\Bigl|\\int_{\\gamma_2} e^{i\\lambda z^2}\\,dz\\Bigr|\n\\le\n\\int_{\\rho_0}^R e^{-\\lambda\\rho^2}\\,|dz|\n\\le\n\\int_{\\rho_0}^R e^{-\\lambda\\rho^2}\\,d\\rho\n\\le\n\\int_{\\rho_0}^{\\infty} e^{-\\lambda\\rho^2}\\,d\\rho\n\\to 0\\quad\\text{as }R\\to\\infty,\n\\]\nand the same estimate applies to $\\gamma_4$.\n\nTherefore, letting $R\\to\\infty$, the contributions from $\\gamma_2$ and $\\gamma_4$ vanish, while $\\gamma_1$ tends to the whole real axis and $\\gamma_3$ tends to the whole steepest descent line $\\Gamma_{\\mathrm{sd}}$. We obtain\n\\[\n\\int_{-\\infty}^{\\infty} e^{i\\lambda x^2}\\,dx\n=\n\\int_{\\Gamma_{\\mathrm{sd}}} e^{i\\lambda z^2}\\,dz.\n\\]\nCombining this with the computation in step 2,\n\\[\nI(\\lambda)\n=\n\\int_{-\\infty}^{\\infty} e^{i\\lambda x^2}\\,dx\n=\ne^{i\\pi/4}\\sqrt{\\frac{\\pi}{\\lambda}},\n\\qquad \\lambda>0.\n\\]\n\n\\medskip\n\n\\textbf{4. Relation to the general method of steepest descent.}\n\nIn this example:\n\n\\begin{itemize}\n\\item The phase function is $f(z)=iz^2$ with a nondegenerate saddle at $z_0=0$ ($f'(0)=0$, $f''(0)=2i\\neq0$).\n\\item Near the saddle one may approximate\n\\[\nf(z) \\approx f(0) + \\tfrac12 f''(0)(z-0)^2 = i z^2,\n\\qquad g(z) \\approx g(0)=1,\n\\]\nso the integrand is locally modeled by a Gaussian in the complex variable $z$.\n\\item Choosing a contour through $z_0$ along which $\\Im f$ is constant and $\\Re f$ decreases away from $z_0$ (a steepest descent path) reduces the local contribution of the integral to a real Gaussian integral, which can be evaluated explicitly.\n\\end{itemize}\n\nFor a general analytic $f$ with a nondegenerate saddle at $z_0$ and analytic $g$ with $g(z_0)\\neq0$, one linearizes $g$ and quadratically approximates $f$ near $z_0$:\n\\[\nf(z) \\approx f(z_0) + \\frac{f''(z_0)}{2}(z-z_0)^2,\n\\qquad\ng(z) \\approx g(z_0),\n\\]\nand deforms the contour so that near $z_0$ it follows a steepest descent direction.  After a suitable change of variables, the local contribution becomes proportional to the standard Gaussian integral, yielding the leading asymptotics\n\\[\n\\int_\\Gamma e^{\\lambda f(z)}g(z)\\,dz\n\\sim\ng(z_0)\\,e^{\\lambda f(z_0)}\\,\n\\sqrt{\\frac{2\\pi}{\\lambda f''(z_0)}}\n\\quad\\text{as }\\lambda\\to\\infty,\n\\]\nwhere the square root and the contour are chosen consistently with the chosen steepest descent direction.  The present computation of $I(\\lambda)$ is the simplest concrete instance of this general saddle-point/steepest-descent principle.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 3304, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 4791, "output_tokens_details": {"reasoning_tokens": 2960}, "total_tokens": 8095}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199153234819092ca26dc387cf7ba", "custom_id": "example::complex-analysis::extreme-stationary-and-saddle-point-methods::3", "response": {"status_code": 200, "request_id": "98f51259317d0c7b10fe54ec15dc7ea9", "body": {"id": "resp_033ddfe84e5d374c00693197a34ca481908f75044d6db37bff", "object": "response", "created_at": 1764857763, "status": "incomplete", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": {"reason": "max_output_tokens"}, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_033ddfe84e5d374c00693197a392148190896533d952626083", "type": "reasoning", "summary": []}, {"id": "msg_033ddfe84e5d374c00693197bd46bc81908e390cc235b43fd0", "type": "message", "status": "incomplete", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": ")$ as $\\lambda\\to\\infty$.\n\n\\medskip\n\\noindent\\textbf{Solution.}\n\\begin{enumerate}[(a)]\n\n\\item We write\n\\[\nJ_\\nu(\\lambda)\n=\n\\frac{1}{2\\pi i}\\int_{|z|=1}\n\\exp\\!\\left(\\frac{\\lambda}{2}\\Bigl(z-\\frac{1}{z}\\Bigr)\\right)\n\\,z^{-\\nu-1}\\,dz\n=\n\\frac{1}{2\\pi i}\\int_{|z|=1} e^{\\lambda\\phi(z)}\\,a(z)\\,dz,\n\\]\nwith\n\\[\n\\phi(z) \\coloneqq \\frac12\\Bigl(z-\\frac{1}{z}\\Bigr),\n\\qquad\na(z) \\coloneqq z^{-\\nu-1}.\n\\]\n\nHere $\\phi$ is independent of $\\nu$. For $\\lambda\\gg 1$ and fixed $\\nu$, the factor $e^{\\lambda\\phi(z)}$ varies rapidly because its exponent is $O(\\lambda)$, while $a(z)$ varies on the $O(1)$ scale (it is analytic and bounded on and near $|z|=1$). Thus $e^{\\lambda\\phi(z)}$ is the rapidly varying part and $a(z)$ the slowly varying part.\n\n\\item\nWe compute\n\\[\n\\phi'(z)\n=\n\\frac12\\left(1+\\frac{1}{z^2}\\right).\n\\]\nThe saddle points satisfy $\\phi'(z)=0$, hence\n\\[\n1+\\frac{1}{z^2}=0\n\\quad\\Longrightarrow\\quad\nz^2=-1,\\qquad z=\\pm i.\n\\]\nBoth lie on the unit circle $|z|=1$.\n\nThe values of the phase are\n\\[\n\\phi(i)\n= \\frac12\\Bigl(i - \\frac{1}{i}\\Bigr)\n= \\frac12(i - (-i)) = i,\n\\]\n\\[\n\\phi(-i)\n= \\frac12\\Bigl(-i - \\frac{1}{-i}\\Bigr)\n= \\frac12(-i - i) = -i.\n\\]\n\nWe also need $\\phi''(z)$:\n\\[\n\\phi''(z)\n=\n\\frac12\\left(0 - \\frac{(-2)}{z^3}\\right)\n=\n-\\frac{1}{z^3}.\n\\]\nThus\n\\[\n\\phi''(i) = -\\frac{1}{i^3},\\qquad i^3=-i\n\\ \\Rightarrow\\\n\\phi''(i) = -\\frac{1}{-i} = \\frac{1}{i} = -i,\n\\]\n\\[\n\\phi''(-i) = -\\frac{1}{(-i)^3},\\qquad(-i)^3=i\n\\ \\Rightarrow\\\n\\phi''(-i) = -\\frac{1}{i} = -(-i)= i.\n\\]\n\n\\item\nNear a saddle $z_s$ we use\n\\[\n\\phi(z)\\approx \\phi(z_s)+\\frac12\\phi''(z_s)(z-z_s)^2.\n\\]\n\n\\begin{enumerate}[(i)]\n\\item For $z_s=i$, write\n\\[\nz = i + \\rho e^{i\\beta},\\qquad \\rho>0\\ \\text{small}.\n\\]\nThen\n\\[\n\\phi(z)\\approx \\phi(i) + \\frac12\\phi''(i)\\rho^2 e^{2i\\beta}\n= i + \\frac12(-i)\\rho^2 e^{2i\\beta}.\n\\]\nThe change in the exponent $\\lambda\\phi(z)$ relative to $\\lambda\\phi(i)$ is\n\\[\n\\lambda\\left[\\phi(z)-\\phi(i)\\right]\n\\approx \\frac{\\lambda\\rho^2}{2}\\,(-i\\,e^{2i\\beta})\n=\n\\frac{\\lambda\\rho^2}{2}\\,e^{i(2\\beta-\\pi/2)}.\n\\]\nThus\n\\[\n\\Re\\bigl(\\lambda[\\phi(z)-\\phi(i)]\\bigr)\n=\n\\frac{\\lambda\\rho^2}{2}\\cos\\bigl(2\\beta-\\tfrac{\\pi}{2}\\bigr)\n=\n\\frac{\\lambda\\rho^2}{2}\\sin(2\\beta).\n\\]\n\nA path of steepest descent through $z=i$ must make this real part as negative as possible: we want $\\sin(2\\beta)=-1$, i.e.\n\\[\n2\\beta = -\\frac{\\pi}{2} + 2k\\pi\n\\quad\\Rightarrow\\quad\n\\beta = -\\frac{\\pi}{4} + k\\pi.\n\\]\nOne such direction is\n\\[\n\\beta = \\frac{3\\pi}{4},\n\\]\nalong which $\\Re\\phi(z)$ decreases most rapidly away from $z=i$.\n\n\\item\nChoose a local steepest\u2013descent path through $i$ with direction $\\beta=3\\pi/4$:\n\\[\nz = i + \\frac{s}{\\sqrt{\\lambda}} e^{i3\\pi/4},\\qquad s\\in\\mathbb{R}.\n\\]\nThen\n\\[\nz-i = \\frac{s}{\\sqrt{\\lambda}}e^{i3\\pi/4},\n\\qquad\n(z-i)^2 = \\frac{s^2}{\\lambda}e^{i3\\pi/2}\n= \\frac{s^2}{\\lambda}(-i),\n\\]\nand\n\\[\n\\phi(z)\n\\approx\n\\phi(i)+\\frac12\\phi''(i)(z-i)^2\n=\ni + \\frac12(-i)\\cdot\\frac{s^2}{\\lambda}(-i)\n= i - \\frac{s^2}{2\\lambda}.\n\\]\nHence\n\\[\n\\lambda\\phi(z) \\approx \\lambda i - \\frac{s^2}{2}.\n\\]\n\nThe amplitude $a(z)$ is analytic near $i$, so\n\\[\na(z) = a(i) + O\\Bigl(\\frac{|s|}{\\sqrt{\\lambda}}\\Bigr),\n\\]\nand along this path\n\\[\ndz = \\frac{e^{i3\\pi/4}}{\\sqrt{\\lambda}}\\,ds.\n\\]\n\nRestricting to a small neighborhood of $i$ and extending $s$ to $\\pm\\infty$ (which introduces only exponentially small error), the local contribution of the saddle $z=i$ is\n\\[\n\\begin{aligned}\n\\text{(from }z=i\\text{)}\n&\\approx\n\\frac{1}{2\\pi i}\\int_{-\\infty}^{\\infty}\ne^{\\lambda\\phi(z)}\\,a(z)\\,dz\n\\\\\n&\\approx\n\\frac{1}{2\\pi i}\n\\int_{-\\infty}^{\\infty}\ne^{\\lambda i - s^2/2}\\,a(i)\\,\n\\frac{e^{i3\\pi/4}}{\\sqrt{\\lambda}}\\,ds\n\\\\[0.3em]\n&=\n\\frac{1}{2\\pi i}e^{\\lambda i}a(i)e^{i3\\pi/4}\n\\frac{1}{\\sqrt{\\lambda}}\n\\int_{-\\infty}^{\\infty}e^{-s^2/2}\\,ds\n\\\\[0.3em]\n&=\n\\frac{1}{2\\pi i}e^{\\lambda i}a(i)e^{i3\\pi/4}\n\\sqrt{\\frac{2\\pi}{\\lambda}},\n\\end{aligned}\n\\]\nup to an error of order $O(\\lambda^{-3/2})$ coming from the neglected terms in the expansions of $\\phi$ and $a$.\n\n\\end{enumerate}\n\nFor the saddle at $z=-i$, we proceed analogously. Here $\\phi(-i)=-i$, $\\phi''(-i)=i$. A steepest\u2013descent direction is given by $\\beta=\\pi/4$, so we parametrize\n\\[\nz = -i + \\frac{s}{\\sqrt{\\lambda}}e^{i\\pi/4},\\qquad s\\in\\mathbb{R}.\n\\]\nThen $(z+ i)^2 = (z-(-i))^2 = \\frac{s^2}{\\lambda}e^{i\\pi/2}=\\frac{s^2}{\\lambda}i$, and\n\\[\n\\phi(z)\\approx -i + \\frac12 i\\cdot\\frac{s^2}{\\lambda}i\n= -i - \\frac{s^2}{2\\lambda},\n\\quad\\Rightarrow\\quad\n\\lambda\\phi(z) \\approx -\\lambda i - \\frac{s^2}{2}.\n\\]\nMoreover $dz = \\frac{e^{i\\pi/4}}{\\sqrt{\\lambda}}\\,ds$ and $a(z)\\approx a(-i)$. Hence\n\\[\n\\text{(from }z=-i\\text{)}\n\\;\\approx\\;\n\\frac{1}{2\\pi i}e^{-\\lambda i}a(-i)e^{i\\pi/4}\n\\sqrt{\\frac{2\\pi}{\\lambda}},\n\\]\nagain up to $O(\\lambda^{-3/2})$.\n\n\\item\n\\begin{enumerate}[(i)]\n\\item\nUsing the principal branch $-\\pi<\\arg z<\\pi$, we have\n\\[\n\\arg(i)=\\frac{\\pi}{2},\\quad\\arg(-i)=-\\frac{\\pi}{2},\n\\]\nso\n\\[\ni^{-\\nu-1} = e^{-(\\nu+1)\\log i}\n= e^{-(\\nu+1)i\\pi/2},\n\\]\n\\[\n(-i)^{-\\nu-1} = e^{-(\\nu+1)\\log(-i)}\n= e^{-(\\nu+1)(-i\\pi/2)}\n= e^{i(\\nu+1)\\pi/2}.\n\\]\nThus\n\\[\na(i)=i^{-\\nu-1}=e^{-i(\\nu+1)\\pi/2},\\qquad\na(-i)=(-i)^{-\\nu-1}=e^{i(\\nu+1)\\pi/2}.\n\\]\n\n\\item\nAdding the two saddle contributions, we obtain\n\\[\n\\begin{aligned}\nJ_\\nu(\\lambda)\n&\\sim\n\\frac{1}{2\\pi i}\\sqrt{\\frac{2\\pi}{\\lambda}}\n\\Bigl[\ne^{i\\lambda}a(i)e^{i3\\pi/4}\n+\ne^{-i\\lambda}a(-i)e^{i\\pi/4}\n\\Bigr]\n\\\\[0.3em]\n&=\n\\frac{1}{2\\pi i}\\sqrt{\\frac{2\\pi}{\\lambda}}\n\\Bigl[\ne^{i\\lambda}\\,e^{-i(\\nu+1)\\pi/2}\\,e^{i3\\pi/4}\n+\ne^{-i\\lambda}\\,e^{i(\\nu+1)\\pi/2}\\,e^{i\\pi/4}\n\\Bigr].\n\\end{aligned}\n\\]\n\nSimplify the exponents. For the first term,\n\\[\ne^{i\\lambda}\\,e^{-i(\\nu+1)\\pi/2}\\,e^{i3\\pi/4}\n=\n\\exp\\Bigl\\{\\,i\\bigl[\\lambda - (\\nu+1)\\tfrac{\\pi}{2} + \\tfrac{3\\pi}{4}\\bigr]\\Bigr\\}.\n\\]\nNote\n\\[\n-(\\nu+1)\\frac{\\pi}{2}+\\frac{3\\pi}{4}\n= -\\frac{(2\\nu+2)\\pi}{4} + \\frac{3\\pi}{4}\n= -\\frac{(2\\nu-1)\\pi}{4},\n\\]\nso the first exponent is\n\\[\ni\\Bigl[\\lambda - \\frac{(2\\nu-1)\\pi}{4}\\Bigr].\n\\]\n\nFor the second term,\n\\[\ne^{-i\\lambda}\\,e^{i(\\nu+1)\\pi/2}\\,e^{i\\pi/4}\n=\n\\exp\\Bigl\\{\\,i\\bigl[-\\lambda + (\\nu+1)\\tfrac{\\pi}{2} + \\tfrac{\\pi}{4}\\bigr]\\Bigr\\}.\n\\]\nHere\n\\[\n(\\nu+1)\\frac{\\pi}{2}+\\frac{\\pi}{4}\n= \\frac{(2\\nu+2)\\pi}{4} + \\frac{\\pi}{4}\n= \\frac{(2\\nu+3)\\pi}{4}\n= \\frac{(2\\nu-1)\\pi}{4} + \\pi,\n\\]\nhence the second exponent equals\n\\[\ni\\Bigl[-\\lambda + \\frac{(2\\nu-1)\\pi}{4} + \\pi\\Bigr]\n\\]\nand thus\n\\[\ne^{-i\\lambda}e^{i(\\nu+1)\\pi/2}e^{i\\pi/4}\n= -\\exp\\Bigl\\{\\,i\\bigl[-\\lambda + \\tfrac{(2\\nu-1)\\pi}{4}\\bigr]\\Bigr\\}.\n\\]\n\nLet\n\\[\n\\theta \\coloneqq \\lambda - \\frac{(2\\nu-1)\\pi}{4}.\n\\]\nThen the bracket becomes\n\\[\ne^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta,\n\\]\nso\n\\[\n\\begin{aligned}\nJ_\\nu(\\lambda)\n&\\sim\n\\frac{1}{2\\pi i}\\sqrt{\\frac{2\\pi}{\\lambda}}\\,\n(2i\\sin\\theta)\n=\n\\frac{1}{\\pi}\\sqrt{\\frac{2\\pi}{\\lambda}}\\,\n\\sin\\theta\n\\\\[0.3em]\n&=\n\\sqrt{\\frac{2}{\\pi\\lambda}}\\,\n\\sin\\Bigl(\\lambda - \\frac{(2\\nu-1)\\pi}{4}\\Bigr).\n\\end{aligned}\n\\]\nBut\n\\[\n\\lambda - \\frac{(2\\nu-1)\\pi}{4}\n=\n\\lambda - \\frac{\\nu\\pi}{2} + \\frac{\\pi}{4}\n=\n\\Bigl(\\lambda - \\frac{\\nu\\pi}{2} - \\frac{\\pi}{4}\\Bigr) + \\frac{\\pi}{2},\n\\]\nso\n\\[\n\\sin\\Bigl(\\lambda - \\frac{(2\\nu-1)\\pi}{4}\\Bigr)\n=\n\\sin\\Bigl[\\Bigl(\\lambda - \\frac{\\nu\\pi}{2} - \\frac{\\pi}{4}\\Bigr)+\\frac{\\pi}{2}\\Bigr]\n=\n\\cos\\Bigl(\\lambda - \\frac{\\nu\\pi}{2} - \\frac{\\pi}{4}\\Bigr).\n\\]\nTherefore\n\\[\nJ_\\nu(\\lambda)\n\\sim\n\\sqrt{\\frac{2}{\\pi\\lambda}}\\,\n\\cos\\Bigl(\\lambda - \\frac{\\nu\\pi}{2} - \\frac{\\pi}{4}\\Bigr),\n\\qquad \\lambda\\to+\\infty,\n\\]\nwhich is the standard leading asymptotic form.\n\n\\end{enumerate}\n\n\\item (Extensions.)\n\n\\begin{enumerate}[(i)]\n\\item\nFor the modified Bessel function $I_\\nu(\\lambda)$ one has an integral of the form\n\\[\nI_\\nu(\\lambda)\n\\propto\n\\int_{|z|=1}\n\\exp\\!\\left(\\frac{\\lambda}{2}\\Bigl(z+\\frac{1}{z}\\Bigr)\\right)\nz^{-\\nu-1}\\,dz,\n\\]\nso the phase is\n\\[\n\\phi_I(z) = \\frac12\\Bigl(z+\\frac{1}{z}\\Bigr).\n\\]\nIts saddles satisfy\n\\[\n\\phi_I'(z) = \\frac12\\Bigl(1-\\frac{1}{z^2}\\Bigr)=0\n\\quad\\Rightarrow\\quad\nz^2=1,\\ z=\\pm1,\n\\]\nlying on the real axis. For real $\\lambda>0$, $\\Re\\phi_I(1)=1$ and $\\Re\\phi_I(-1)=-1$, so the dominant contribution comes from $z=1$ with"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1980, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 8000, "output_tokens_details": {"reasoning_tokens": 4394}, "total_tokens": 9980}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69319915283c8190809b6a46c7b43a20", "custom_id": "example::complex-analysis::extreme-stationary-and-saddle-point-methods::4", "response": {"status_code": 200, "request_id": "28d6e3b413f8daebc6de7cc2135e148c", "body": {"id": "resp_0f9830562df018ec00693197d07c6c8195b3bdce14da1fe38c", "object": "response", "created_at": 1764857808, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0f9830562df018ec00693197d0cc58819589de0db3e9afc33f", "type": "reasoning", "summary": []}, {"id": "msg_0f9830562df018ec00693197d27be08195ad40d009dd886281", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "integral with a rapidly oscillating phase depending on a large parameter ($t$ in this case).\n\n\\item One identifies stationary points of the phase (here, a unique stationary point $\\xi_0 = x/(2t)$) and checks their nondegeneracy.\n\n\\item The phase is Taylor-expanded to second order around the stationary point, and the variables are rescaled so that the quadratic term has order one while the large parameter factors out explicitly (producing the prefactor $t^{-1/2}$).\n\n\\item A standard stationary phase lemma is applied to the resulting integral, yielding an explicit leading term plus an error controlled by derivatives of the amplitude. This leading term gives both the precise oscillatory behavior and the decay rate of the solution in $t$ at each fixed $x$.\n\n\\item The fact that the phase is quadratic and nondegenerate leads to $t^{-1/2}$ decay in one dimension; more generally, higher-order or degenerate phases produce slower decay, and higher spatial dimensions change the power of $t$ through the determinant of the Hessian at the stationary point.\n\\end{itemize}\n\nIn summary, the stationary phase method turns the Fourier representation of the Schr\\\"odinger solution into a concrete asymptotic expansion, explaining how dispersion leads to pointwise decay even though the $L^2$ norm is conserved.\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 6803, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 525, "output_tokens_details": {"reasoning_tokens": 231}, "total_tokens": 7328}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6931991540748190b5e6fec7b86c677b", "custom_id": "example::fourier-analysis::the-fourier-transform-and-inverse-fourier-transform::4", "response": {"status_code": 200, "request_id": "cd7c34540e50af00c4ecc23bd2263093", "body": {"id": "resp_0d58cc083662439000693197d8b20c81959be141e2171ac818", "object": "response", "created_at": 1764857816, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0d58cc083662439000693197d902148195b441b719313374c8", "type": "reasoning", "summary": []}, {"id": "msg_0d58cc083662439000693197dd6afc8195925515b9d09daf54", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": ")^4$.\n\nThus\n\\[\n\\widehat{u}(t,\\xi) = e^{-t(2\\pi\\xi)^4}\\,\\widehat{f}(\\xi).\n\\]\n\n\\medskip\n\n\\emph{Smoothing in $x$ for $t>0$.}\n\nFix $t>0$. For each integer $m\\ge 0$,\n\\[\n\\xi^m\\,\\widehat{u}(t,\\xi)\n= \\bigl[\\xi^m e^{-t(2\\pi\\xi)^4}\\bigr]\\,\\widehat{f}(\\xi).\n\\]\nThe factor $\\xi^m e^{-t(2\\pi\\xi)^4}$ is a polynomial times a rapidly decaying exponential. In particular, it is bounded:\n\\[\n\\sup_{\\xi\\in\\mathbb{R}} \\bigl|\\xi^m e^{-t(2\\pi\\xi)^4}\\bigr| < \\infty,\n\\quad\\text{for each fixed } t>0,m\\ge 0.\n\\]\nIf, for example, $\\widehat{f}\\in L^1(\\mathbb{R})$, then for each $m$,\n\\[\n\\xi^m\\,\\widehat{u}(t,\\xi) \\in L^1(\\mathbb{R}),\n\\]\nbecause it is $\\widehat{f}(\\xi)$ multiplied by a bounded function. Applying part (b) to $u(t,\\cdot)$ (with $\\widehat{u}(t,\\xi)$ in place of $\\widehat{f}(\\xi)$) shows that $u(t,\\cdot)$ has $m$ continuous derivatives for every $m$. Since $m$ is arbitrary, $u(t,\\cdot)$ is $C^\\infty$ in $x$ for each $t>0$.\n\nIn other words, even if the initial data $f$ is only moderately regular, the solution $u(t,\\cdot)$ becomes instantly very smooth in the spatial variable for any positive time $t$. The strong decay of the factor $e^{-t(2\\pi\\xi)^4}$ at high frequencies damps the high-frequency components of $\\widehat{f}$, and by the decay\u2013regularity principle from part (b), this enhanced decay translates into arbitrarily high regularity of $u(t,\\cdot)$ in $x$.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 6461, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 1122, "output_tokens_details": {"reasoning_tokens": 596}, "total_tokens": 7583}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199153eb88190844a751ad1850387", "custom_id": "example::fourier-analysis::laplace-transform::1", "response": {"status_code": 200, "request_id": "16c24d95d8f80c302cf3c85a5d73d51e", "body": {"id": "resp_0e14ae533164697a00693197e470588190ac8c469e28787f56", "object": "response", "created_at": 1764857828, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0e14ae533164697a00693197e4a8c88190806ece5bb54f335d", "type": "reasoning", "summary": []}, {"id": "msg_0e14ae533164697a00693197edd0b88190acacb088d3a23bd4", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "stituting the expression for $B$ into this equation yields\n\\[\n-\\frac{A(\\omega_0^2-\\omega^2)^2}{2\\gamma} - 2\\gamma A \\omega^2 = F_0 \\omega.\n\\]\nFactor out $A$ and combine terms:\n\\[\n-A\\left(\\frac{(\\omega_0^2-\\omega^2)^2}{2\\gamma} + 2\\gamma \\omega^2\\right) = F_0 \\omega,\n\\]\nso\n\\[\nA\\left(\\frac{(\\omega_0^2-\\omega^2)^2 + 4\\gamma^2 \\omega^2}{2\\gamma}\\right) = -F_0 \\omega.\n\\]\nThus\n\\[\nA = -\\frac{2\\gamma F_0 \\omega}{(\\omega_0^2-\\omega^2)^2 + 4\\gamma^2 \\omega^2}.\n\\]\nRecall that\n\\[\nB = -\\frac{A(\\omega_0^2-\\omega^2)}{2\\gamma},\\quad\nC = -A,\\quad\nD = -\\gamma A - B.\n\\]\nSubstituting for $A$ gives\n\\[\nC = \\frac{2\\gamma F_0 \\omega}{(\\omega_0^2-\\omega^2)^2 + 4\\gamma^2 \\omega^2},\n\\]\n\\[\nB = \\frac{F_0 \\omega(\\omega_0^2-\\omega^2)}{(\\omega_0^2-\\omega^2)^2 + 4\\gamma^2 \\omega^2},\n\\]\n\\[\nD = \\frac{F_0 \\omega\\bigl(2\\gamma^2 - \\omega_0^2 + \\omega^2\\bigr)}\n           {(\\omega_0^2-\\omega^2)^2 + 4\\gamma^2 \\omega^2}.\n\\]\n\nFor convenience, define the common denominator\n\\[\n\\Delta(\\omega) = (\\omega_0^2-\\omega^2)^2 + 4\\gamma^2 \\omega^2 > 0.\n\\]\n\nNow we invert the Laplace transform. From \\eqref{eq:pf} we have\n\\[\nX(s) = \\frac{A s + B}{s^2+\\omega^2} \\;+\\; \\frac{C (s+\\gamma) + D}{(s+\\gamma)^2+\\Omega^2},\n\\]\nso by linearity and the standard formulas\n\\[\n\\mathcal{L}^{-1}\\left\\{\\frac{s}{s^2+\\alpha^2}\\right\\} = \\cos(\\alpha t), \\quad\n\\mathcal{L}^{-1}\\left\\{\\frac{1}{s^2+\\alpha^2}\\right\\} = \\frac{1}{\\alpha}\\sin(\\alpha t),\n\\]\nand the shift rule\n\\[\n\\mathcal{L}^{-1}\\{F(s+\\gamma)\\}(t) = e^{-\\gamma t} f(t),\n\\]\nwe get\n\\begin{align*}\nx(t)\n &= A\\cos(\\omega t) + \\frac{B}{\\omega}\\sin(\\omega t)\n    + C e^{-\\gamma t}\\cos(\\Omega t)\n    + \\frac{D}{\\Omega} e^{-\\gamma t}\\sin(\\Omega t).\n\\end{align*}\nSubstituting $A,B,C,D$ in terms of $\\Delta(\\omega)$, we can separate $x(t)$ naturally into a steady-state and a transient part.\n\n\\medskip\\noindent\n\\textbf{Steady-state term.}\nThe terms involving $\\sin(\\omega t)$ and $\\cos(\\omega t)$ (with no exponential factor) form the steady-state solution:\n\\begin{align*}\nx_{\\text{ss}}(t)\n &= A\\cos(\\omega t) + \\frac{B}{\\omega}\\sin(\\omega t)\\\\\n &= \\frac{F_0}{\\Delta(\\omega)}\\Bigl[-2\\gamma\\omega\\cos(\\omega t)\n     + (\\omega_0^2-\\omega^2)\\sin(\\omega t)\\Bigr].\n\\end{align*}\nThis is a sinusoidal motion at the driving frequency $\\omega$ that persists for large $t$.\n\n\\medskip\\noindent\n\\textbf{Transient term.}\nThe terms multiplied by $e^{-\\gamma t}$ form the transient:\n\\begin{align*}\nx_{\\text{tr}}(t)\n &= C e^{-\\gamma t}\\cos(\\Omega t)\n    + \\frac{D}{\\Omega}e^{-\\gamma t}\\sin(\\Omega t)\\\\\n &= e^{-\\gamma t}\\left[\n      \\frac{2\\gamma F_0 \\omega}{\\Delta(\\omega)}\\cos(\\Omega t)\n      + \\frac{F_0 \\omega\\bigl(2\\gamma^2 - \\omega_0^2 + \\omega^2\\bigr)}\n             {\\Omega\\,\\Delta(\\omega)}\\sin(\\Omega t)\\right].\n\\end{align*}\nBecause of the factor $e^{-\\gamma t}$, we have\n\\[\n\\lim_{t\\to\\infty} x_{\\text{tr}}(t) = 0.\n\\]\n\n\\medskip\\noindent\n\\textbf{Final solution and long-time behavior.}\nCombining the two parts,\n\\[\nx(t) = x_{\\text{tr}}(t) + x_{\\text{ss}}(t),\n\\]\nwhere\n\\[\nx_{\\text{tr}}(t) = e^{-\\gamma t}\\left[\n      \\frac{2\\gamma F_0 \\omega}{\\Delta(\\omega)}\\cos(\\Omega t)\n      + \\frac{F_0 \\omega\\bigl(2\\gamma^2 - \\omega_0^2 + \\omega^2\\bigr)}\n             {\\Omega\\,\\Delta(\\omega)}\\sin(\\Omega t)\\right],\n\\]\n\\[\nx_{\\text{ss}}(t) =\n\\frac{F_0}{\\Delta(\\omega)}\\Bigl[-2\\gamma\\omega\\cos(\\omega t)\n     + (\\omega_0^2-\\omega^2)\\sin(\\omega t)\\Bigr].\n\\]\n\nThe \\emph{transient} $x_{\\text{tr}}(t)$ decays to zero as $t\\to\\infty$ because of the factor $e^{-\\gamma t}$; it represents damped oscillations at the damped natural frequency $\\Omega$. The \\emph{steady-state} term $x_{\\text{ss}}(t)$ persists for large $t$ and oscillates at the driving frequency $\\omega$ with a phase shift relative to the forcing.\n\nWriting $x_{\\text{ss}}$ in the form\n\\[\nx_{\\text{ss}}(t) = R(\\omega)\\,\\sin(\\omega t - \\delta(\\omega)),\n\\]\none finds\n\\[\nR(\\omega)\n  = \\frac{F_0}{\\sqrt{(\\omega_0^2-\\omega^2)^2 + 4\\gamma^2\\omega^2}},\n\\]\nso as the damping $\\gamma$ becomes small and the driving frequency $\\omega$ approaches $\\omega_0$, the denominator becomes very small and the amplitude $R(\\omega)$ becomes very large: this is the resonance phenomenon.\n\nFrom the Laplace-transform viewpoint, the poles of $X(s)$ at $s=-\\gamma\\pm i\\Omega$ produce the transient (damped natural oscillations), while the poles at $s=\\pm i\\omega$ generate the steady-state response at the driving frequency. The method systematically incorporates initial conditions and makes the separation between transient and steady-state behavior transparent in terms of these poles.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 3838, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 3414, "output_tokens_details": {"reasoning_tokens": 1722}, "total_tokens": 7252}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199151e04819087808764dfd011a0", "custom_id": "example::fourier-analysis::from-differential-to-algebraic-equations-with-ft-fs-and-lt::3", "response": {"status_code": 200, "request_id": "cf82e0c1e2107aabfc06fcadc62fcfb5", "body": {"id": "resp_045a9d9151bcf6f400693197f98ad88190ade38c8f5f1576f9", "object": "response", "created_at": 1764857849, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_045a9d9151bcf6f400693197f9e9ac8190b896934566138468", "type": "reasoning", "summary": []}, {"id": "msg_045a9d9151bcf6f40069319804623c81908e2e6e33ded39c38", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "(\\omega)}$, but this is somewhat tedious.\n  \\item A cleaner route is to use the transfer-function viewpoint (or an equivalent complex-exponential computation), which we outline next.\n\\end{itemize}\n\nRewrite \\eqref{eq:Xs-basic} as\n\\[\nX(s)\n= \\frac{1}{m s^2 + c s + k}\\;\\cdot\\;\\frac{F_0 s}{s^2 + \\omega^2}\n= H(s)\\,\\mathcal{L}\\{F_0 \\cos(\\omega t)\\}(s),\n\\]\nwhere\n\\[\nH(s) = \\frac{1}{m s^2 + c s + k}\n\\]\nis the system\u2019s transfer function from input force $F_{\\text{ext}}$ to output displacement $x$.\n\nFor a sinusoidal input $F_{\\text{ext}}(t) = F_0\\cos(\\omega t)$, the long-time (steady-state) response of a stable linear system is sinusoidal at the same frequency, with complex \\emph{gain} $H(i\\omega)$:\n\\[\nx_{\\mathrm{ss}}(t)\n= \\Re\\Bigl\\{H(i\\omega)\\,F_0 e^{i\\omega t}\\Bigr\\}.\n\\]\nThus the steady-state amplitude is\n\\[\nR(\\omega) = F_0\\,|H(i\\omega)|.\n\\]\n\nNow\n\\[\nH(i\\omega) = \\frac{1}{m (i\\omega)^2 + c (i\\omega) + k}\n= \\frac{1}{k - m\\omega^2 + i c \\omega}.\n\\]\nHence\n\\[\n|H(i\\omega)|\n= \\frac{1}{\\sqrt{(k - m\\omega^2)^2 + (c\\omega)^2}},\n\\]\nand\n\\[\nR(\\omega) = \\frac{F_0}{\\sqrt{(k - m\\omega^2)^2 + c^2 \\omega^2}}.\n\\]\n\nThis agrees with the amplitude obtained by writing\n\\[\nx_{\\mathrm{ss}}(t) = A \\cos(\\omega t) + \\frac{B}{\\omega} \\sin(\\omega t)\n= R(\\omega)\\cos\\bigl(\\omega t - \\delta(\\omega)\\bigr),\n\\]\nwith\n\\[\nR(\\omega) = \\sqrt{A^2 + \\left(\\frac{B}{\\omega}\\right)^2}.\n\\]\n\nThis completes part (b): the steady-state solution has the form\n\\[\nx_{\\mathrm{ss}}(t) = R(\\omega)\\cos\\bigl(\\omega t - \\delta(\\omega)\\bigr),\n\\quad\nR(\\omega) = \\frac{F_0}{\\sqrt{(k - m\\omega^2)^2 + c^2 \\omega^2}}.\n\\]\n\n\\medskip\n\n\\noindent\\textbf{Step 5: Behavior of $R(\\omega)$ and resonance.}\n\nWe now discuss how $R(\\omega)$ behaves as a function of $\\omega$ and interpret resonance via the poles of $X(s)$ (part (c)).\n\n\\medskip\n\n\\noindent\\emph{(i) Shape of $R(\\omega)$ for $c>0$.}\n\nRecall\n\\[\nR(\\omega) = \\frac{F_0}{\\sqrt{(k - m\\omega^2)^2 + c^2 \\omega^2}},\n\\qquad \\omega\\ge 0.\n\\]\n\nBasic features:\n\\begin{itemize}\n  \\item At zero frequency,\n  \\[\n  R(0) = \\frac{F_0}{k},\n  \\]\n  which is just the static deflection of a spring under a constant force.\n  \\item As $\\omega\\to\\infty$,\n  \\[\n  (k - m\\omega^2)^2 \\sim m^2\\omega^4,\n  \\]\n  so $R(\\omega)\\sim F_0/(m\\omega^2)\\to 0$. Very rapid forcing produces little displacement.\n  \\item For $0<c\\ll 1$, $R(\\omega)$ has a pronounced peak near the undamped natural frequency\n  \\[\n  \\omega_0 = \\sqrt{\\frac{k}{m}}.\n  \\]\n\\end{itemize}\n\nTo locate the maximum more precisely, maximize $R(\\omega)$ over $\\omega>0$. Since $F_0$ is constant, this is equivalent to minimizing\n\\[\nD(\\omega) := (k - m\\omega^2)^2 + c^2\\omega^2.\n\\]\nDifferentiating and setting $D'(\\omega)=0$ gives\n\\[\nD'(\\omega)\n= 2(k - m\\omega^2)(-2m\\omega) + 2c^2\\omega\n= 2\\omega\\bigl(-2m(k - m\\omega^2) + c^2\\bigr)\n= 0.\n\\]\nAside from the trivial solution $\\omega=0$, we obtain\n\\[\n-2m(k - m\\omega^2) + c^2 = 0\n\\quad\\Rightarrow\\quad\n2m^2\\omega^2 = 2mk - c^2\n\\quad\\Rightarrow\\quad\n\\omega^2 = \\frac{k}{m} - \\frac{c^2}{2m^2}.\n\\]\nThus the \\emph{resonant frequency} is\n\\[\n\\omega_{\\mathrm{res}}\n= \\sqrt{\\omega_0^2 - \\frac{c^2}{2m^2}},\n\\]\nwhich satisfies $\\omega_{\\mathrm{res}}<\\omega_0$ and approaches $\\omega_0$ as $c\\to 0^+$. So for small but nonzero damping, $R(\\omega)$ has a finite peak slightly below the undamped natural frequency.\n\n\\medskip\n\n\\noindent\\emph{(ii) The undamped case $c=0$ and resonance.}\n\nIf we set $c=0$ in the ODE\n\\[\nm x''(t) + k x(t) = F_0 \\cos(\\omega t),\n\\]\nthen\n\\[\nX(s) = \\frac{F_0\\, s}{(s^2 + \\omega^2)(m s^2 + k)}\n= \\frac{F_0\\, s}{(s^2 + \\omega^2)\\bigl(m s^2 + k\\bigr)}.\n\\]\nThe system\u2019s transfer function becomes\n\\[\nH(s) = \\frac{1}{m s^2 + k},\n\\]\nwith poles at\n\\[\ns = \\pm i\\omega_0, \\qquad \\omega_0 = \\sqrt{\\frac{k}{m}}.\n\\]\nThese poles now lie exactly on the imaginary axis. The forcing term still contributes poles at $s=\\pm i\\omega$ from $s^2+\\omega^2$.\n\nThe steady-state amplitude formula reduces to\n\\[\nR(\\omega)\n= \\frac{F_0}{|k - m\\omega^2|}\n= \\frac{F_0}{m|\\omega_0^2 - \\omega^2|}.\n\\]\nAs $\\omega\\to\\omega_0$, the denominator tends to $0$, so $R(\\omega)\\to\\infty$: the steady-state amplitude is unbounded. In the time domain, at exact resonance $\\omega=\\omega_0$, the particular solution contains a term that grows linearly in $t$, such as\n\\[\nx(t) \\sim \\frac{F_0}{2m\\omega_0}\\,t\\sin(\\omega_0 t),\n\\]\nillustrating classical resonance.\n\n\\medskip\n\n\\noindent\\emph{(iii) Pole motion and resonance in the $s$-plane.}\n\nFrom the transfer function perspective, the frequency response is\n\\[\nH(i\\omega) = \\frac{1}{m(i\\omega)^2 + c(i\\omega) + k}\n= \\frac{1}{k - m\\omega^2 + i c\\omega}.\n\\]\nIts magnitude $|H(i\\omega)|$ is largest when $i\\omega$ lies closest (in the complex plane) to a pole of $H(s)$.\n\n\\begin{itemize}\n  \\item For $c>0$, the poles\n  \\[\n  r_{1,2} = \\frac{-c \\pm \\sqrt{c^2 - 4mk}}{2m}\n  \\]\n  lie in the left half-plane, at $-\\alpha\\pm i\\beta$ ($\\alpha>0$). The imaginary parts $\\pm\\beta$ are close to $\\pm\\omega_0$ when $c$ is small. The point $i\\omega$ on the imaginary axis is closest to these poles when $\\omega\\approx\\beta\\approx\\omega_0$, so $|H(i\\omega)|$ and thus $R(\\omega)$ attain a finite but large maximum near $\\omega_0$.\n  \\item As $c\\to 0^+$, the poles $r_{1,2}$ move horizontally toward the imaginary axis and converge to $\\pm i\\omega_0$. In the limit $c=0$, they sit exactly on the imaginary axis. When the forcing frequency matches $\\omega_0$, the point $s=i\\omega$ coincides with a pole of $H(s)$, and the gain $|H(i\\omega)|$ becomes unbounded. This pole collision on the imaginary axis is the Laplace-domain picture of resonance.\n\\end{itemize}\n\nThus, resonance corresponds to the forcing frequency aligning with the imaginary part of the system\u2019s poles. Damping pushes the poles into the left half-plane, limiting the peak amplitude; removing damping allows the poles to lie on the imaginary axis, leading to unbounded growth at resonance.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 4488, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 3670, "output_tokens_details": {"reasoning_tokens": 1529}, "total_tokens": 8158}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6931991542688190ba7b40c4abe30831", "custom_id": "example::ordinary-differential-equations::linear-dynamics-via-the-green-function::2", "response": {"status_code": 200, "request_id": "9af9491fd4f8c568b4fc168d9701d9af", "body": {"id": "resp_0cb8491cd1d74c0a006931981270288196bae2b22e07748a68", "object": "response", "created_at": 1764857874, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0cb8491cd1d74c0a0069319812b9fc8196b766ab9fe396928c", "type": "reasoning", "summary": []}, {"id": "msg_0cb8491cd1d74c0a00693198178aa88196ac3ba4cccf1b7b6c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "\\(q(0)=0\\) and \\(q'(0)=0\\). Explicitly,\n\\[\nq(0) = q_{\\mathrm{hom}}(0)+q_{\\mathrm{part}}(0)\n      = A_0 + q_{\\mathrm{part}}(0) = 0,\n\\]\n\\[\nq'(0) = q_{\\mathrm{hom}}'(0)+q_{\\mathrm{part}}'(0)\n      = (-\\alpha A_0 + \\omega_d B_0) + q_{\\mathrm{part}}'(0) = 0,\n\\]\nwhich determine \\(A_0\\) and \\(B_0\\) uniquely in terms of the forcing parameters. Their exact values are not important for the qualitative behavior: the homogeneous part is always of the form\n\\[\nq_{\\mathrm{hom}}(t) = e^{-\\alpha t}\\big(A_0\\cos(\\omega_d t) + B_0\\sin(\\omega_d t)\\big),\n\\]\nso it is a \\emph{transient} decaying oscillation at the natural frequency \\(\\omega_d\\).\n\nThus the full solution can be written as\n\\[\nq(t) = q_{\\mathrm{trans}}(t) + q_{\\mathrm{ss}}(t),\n\\]\nwhere\n\\[\nq_{\\mathrm{trans}}(t) = q_{\\mathrm{hom}}(t)\n     = e^{-\\alpha t}\\big(A_0\\cos(\\omega_d t) + B_0\\sin(\\omega_d t)\\big),\n\\]\nand\n\\[\nq_{\\mathrm{ss}}(t) = q_{\\mathrm{part}}(t)\n     = Q(\\omega)\\cos\\big(\\omega t - \\phi(\\omega)\\big)\n\\]\nis the \\emph{steady-state} response at the driving frequency \\(\\omega\\). Because of the exponential factor,\n\\[\n\\lim_{t\\to\\infty} q_{\\mathrm{trans}}(t) = 0,\n\\]\nso in the long-time limit the circuit settles into a pure sinusoidal oscillation at frequency \\(\\omega\\), with amplitude and phase determined by the complex transfer function\n\\[\n\\tilde{Q}(\\omega) = \\frac{V_0}{\\frac{1}{C} - L\\omega^2 + iR\\omega}.\n\\]\n\n\\medskip\n\n\\textbf{(e) Pulsed driving and comparison.}\n\n\\emph{(i) Piecewise integral representation for a pulse.}\n\nNow take\n\\[\nV(t) =\n\\begin{cases}\nV_0, & 0<t<T,\\\\[4pt]\n0, & t\\ge T,\n\\end{cases}\n\\quad (V(t)=0 \\text{ for } t<0).\n\\]\nUsing the convolution formula\n\\[\nq(t) = \\int_0^t G(t-s)V(s)\\,ds,\n\\]\nwe distinguish the cases \\(0<t<T\\) and \\(t\\ge T\\).\n\n\\emph{Case \\(0<t<T\\).}  \nHere the integration interval \\(0\\le s\\le t\\) lies entirely inside the region where \\(V(s)=V_0\\), so\n\\[\nq(t) = \\int_0^t G(t-s)V_0\\,ds\n     = V_0\\int_0^t G(t-s)\\,ds,\\qquad 0<t<T.\n\\]\nEquivalently, with the change of variable \\(\\tau = t-s\\),\n\\[\nq(t) = V_0\\int_0^t G(\\tau)\\,d\\tau,\\qquad 0<t<T.\n\\]\n\n\\emph{Case \\(t\\ge T\\).}  \nNow the integration interval splits: \\(V(s)=V_0\\) only for \\(0<s<T\\), and \\(V(s)=0\\) for \\(T\\le s\\le t\\). Thus\n\\[\nq(t) = \\int_0^T G(t-s)V_0\\,ds + \\int_T^t G(t-s)\\cdot 0\\,ds\n     = V_0\\int_0^T G(t-s)\\,ds,\\qquad t\\ge T.\n\\]\nWith \\(\\tau = t-s\\), this can be written as\n\\[\nq(t) = V_0\\int_{t-T}^{t} G(\\tau)\\,d\\tau,\\qquad t\\ge T.\n\\]\n\nSummarizing,\n\\[\nq(t) =\n\\begin{cases}\nV_0\\displaystyle\\int_0^t G(\\tau)\\,d\\tau, & 0<t<T,\\\\[10pt]\nV_0\\displaystyle\\int_{t-T}^{t} G(\\tau)\\,d\\tau, & t\\ge T.\n\\end{cases}\n\\]\n\n\\medskip\n\n\\emph{(ii) Qualitative comparison: sinusoidal vs pulsed driving.}\n\nIn both drivings, the same Green function\n\\[\nG(t) = \\dfrac{1}{L\\omega_d}e^{-\\alpha t}\\sin(\\omega_d t)\\,H(t)\n\\]\ngoverns the response; the different behaviors arise entirely from how \\(G\\) is weighted and integrated against \\(V(t)\\).\n\n\\begin{itemize}\n\\item \\textbf{Sinusoidal driving.}  \nThe convolution integral continuously accumulates contributions from the ongoing oscillatory input. At each time \\(t\\), the integral includes values of \\(G(\\tau)\\) for \\(\\tau\\) from \\(0\\) up to \\(t\\); older contributions are exponentially suppressed by the factor \\(e^{-\\alpha \\tau}\\), but new contributions at the driving frequency \\(\\omega\\) keep arriving. As a result, after the transient dies out, the system settles into a non-decaying steady-state oscillation at frequency \\(\\omega\\), with amplitude and phase determined by the frequency-domain factor \\(1/(\\frac{1}{C}-L\\omega^2+iR\\omega)\\).\n\n\\item \\textbf{Pulsed driving.}  \nFor \\(0<t<T\\), the situation resembles a constant-voltage drive switched on at \\(t=0\\): the charge builds up via the integral \\(\\int_0^t G(\\tau)\\,d\\tau\\), mixing the natural oscillation of \\(G\\) with the step-like input. Once the pulse ends at \\(t=T\\), the input vanishes and, for \\(t\\ge T\\), the solution is given by an integral of \\(G(\\tau)\\) over a finite, sliding time window \\([t-T,t]\\). Equivalently, for \\(t\\ge T\\), \\(q(t)\\) solves the homogeneous equation with initial data \\(q(T)\\), \\(q'(T)\\); therefore \\(q(t)\\) is a purely transient response:\n\\[\nq(t) = e^{-\\alpha (t-T)}\\big(\\tilde{A}\\cos(\\omega_d (t-T)) + \\tilde{B}\\sin(\\omega_d (t-T))\\big),\n\\]\nfor some constants \\(\\tilde{A},\\tilde{B}\\) determined by the history up to \\(T\\). Because of the damping, this \u201cring-down\u201d oscillation decays to zero:\n\\[\n\\lim_{t\\to\\infty} q(t) = 0.\n\\]\nNo steady oscillation remains, since the source is off for large times.\n\\end{itemize}\n\nThus, in both cases the transient behavior is encoded in the same decaying oscillatory kernel \\(G(t)\\). When the driving persists indefinitely (sinusoidal case), the convolution yields a superposition of a decaying transient plus a non-decaying steady-state oscillation at the driving frequency. When the driving is of finite duration (pulse), the convolution produces only transient behavior: after the pulse, the circuit simply rings at its natural frequency \\(\\omega_d\\) with exponentially decreasing amplitude, eventually returning to equilibrium.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 6532, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 2444, "output_tokens_details": {"reasoning_tokens": 722}, "total_tokens": 8976}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199153b9881908b9687b09e2950d5", "custom_id": "example::ordinary-differential-equations::sturm-liouville-spectral-theory::1", "response": {"status_code": 200, "request_id": "9d735f040d2fd829f6d4cab515060458", "body": {"id": "resp_050edecfb583e81400693198256a088195aff11a574138f7b7", "object": "response", "created_at": 1764857893, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_050edecfb583e8140069319825b1588195bfabcb20388737d6", "type": "reasoning", "summary": []}, {"id": "msg_050edecfb583e8140069319829690081959e7dc486ee0642a0", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "\\left(\\frac{(2k+1)\\pi}{L}\\right)^2 t\\right).\n\\]\n\nThis series solution satisfies the heat equation, the homogeneous Dirichlet boundary conditions, and the uniform initial condition $u(x,0)=1$.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 5131, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 709, "output_tokens_details": {"reasoning_tokens": 638}, "total_tokens": 5840}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199152af48190b61d3e7c5d26d21a", "custom_id": "example::ordinary-differential-equations::sturm-liouville-spectral-theory::2", "response": {"status_code": 200, "request_id": "48c27fc6cd9c2e22d9034bd2abd97fad", "body": {"id": "resp_0b87784a5aa5945a006931982dce388193a6ef97265ba82c05", "object": "response", "created_at": 1764857901, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0b87784a5aa5945a006931982e207c8193a796b908a76a5392", "type": "reasoning", "summary": []}, {"id": "msg_0b87784a5aa5945a006931983258408193be16fbe5f672e984", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "2)P_n'(x)\\bigr) + \\lambda_n P_n(x) = 0,\\qquad\n\\frac{d}{dx}\\bigl((1 - x^2)P_m'(x)\\bigr) + \\lambda_m P_m(x) = 0.\n\\]\nMultiply the first by $P_m$ and the second by $P_n$, then subtract:\n\\[\nP_m\\,\\frac{d}{dx}\\bigl((1 - x^2)P_n'\\bigr)\n- P_n\\,\\frac{d}{dx}\\bigl((1 - x^2)P_m'\\bigr)\n+ (\\lambda_n - \\lambda_m)P_n P_m = 0.\n\\]\nThe first two terms combine into a single derivative:\n\\[\n\\frac{d}{dx}\\Bigl[(1 - x^2)\\bigl(P_m P_n' - P_n P_m'\\bigr)\\Bigr]\n+ (\\lambda_n - \\lambda_m)P_n P_m = 0.\n\\]\nIntegrate from $-1$ to $1$:\n\\[\n\\int_{-1}^{1}\\frac{d}{dx}\\Bigl[(1 - x^2)\\bigl(P_m P_n' - P_n P_m'\\bigr)\\Bigr]\\,dx\n+ (\\lambda_n - \\lambda_m)\\int_{-1}^{1}P_n P_m\\,dx = 0.\n\\]\nThus\n\\[\n(\\lambda_n - \\lambda_m)\\int_{-1}^{1}P_n(x)P_m(x)\\,dx\n= -\\Bigl[(1 - x^2)\\bigl(P_m P_n' - P_n P_m'\\bigr)\\Bigr]_{x=-1}^{x=1}.\n\\]\nBut $P_n$ and $P_m$ are polynomials, so $P_n$, $P_m$, $P_n'$, and $P_m'$ are all bounded at $\\pm1$, and\n\\[\n1 - x^2 = 0\\quad\\text{at}\\quad x = \\pm1,\n\\]\nso the boundary term vanishes:\n\\[\n\\Bigl[(1 - x^2)\\bigl(P_m P_n' - P_n P_m'\\bigr)\\Bigr]_{x=-1}^{x=1} = 0.\n\\]\nHence\n\\[\n(\\lambda_n - \\lambda_m)\\int_{-1}^{1}P_n(x)P_m(x)\\,dx = 0.\n\\]\nFor $m \\ne n$ we have $\\lambda_n \\ne \\lambda_m$, so\n\\[\n\\int_{-1}^{1}P_n(x)P_m(x)\\,dx = 0.\n\\]\nThus the Legendre polynomials corresponding to distinct eigenvalues are orthogonal in $L^2(-1,1)$ with respect to the inner product\n\\[\n\\langle f,g\\rangle = \\int_{-1}^{1} f(x)g(x)\\,dx.\n\\]\n\n\\medskip\n\n\\textbf{Connection with Sturm\u2013Liouville spectral theory.}\n\nIn summary:\n\n- The Legendre equation has been written as a Sturm\u2013Liouville eigenvalue problem\n  \\[\n  L[y] = \\lambda y,\\qquad\n  L[y] = -\\frac{d}{dx}\\bigl((1 - x^2)y'(x)\\bigr),\n  \\]\n  on $(-1,1)$, with weight $w(x)=1$ and boundary condition that $y$ remain bounded at $x=\\pm1$.\n\n- The boundary condition, together with the self-adjoint structure of $L$, forces a \\emph{discrete} spectrum of eigenvalues\n  \\[\n  \\lambda_n = n(n+1),\\quad n=0,1,2,\\dots,\n  \\]\n  obtained by requiring the power series to terminate, yielding polynomial eigenfunctions.\n\n- The corresponding eigenfunctions $P_n$ (Legendre polynomials) are orthogonal with respect to the weight $w(x)$, exactly as predicted by Sturm\u2013Liouville theory for eigenfunctions of a self-adjoint operator.\n\nThis example thus exhibits the typical Sturm\u2013Liouville features: a self-adjoint second-order differential operator with variable coefficients, a discrete set of real eigenvalues, and an associated family of orthogonal eigenfunctions (here, the Legendre polynomials), which form the natural basis for expanding solutions of related boundary value problems (such as Laplace\u2019s equation in spherical coordinates).\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 5308, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 1681, "output_tokens_details": {"reasoning_tokens": 705}, "total_tokens": 6989}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6931991666988190849200e5e3db8150", "custom_id": "example::ordinary-differential-equations::sturm-liouville-spectral-theory::4", "response": {"status_code": 200, "request_id": "428c10951f7891eff7d981dcfdff9d6e", "body": {"id": "resp_06e31f12ad9563d9006931983ac3708193b3a2261ee1a1ca26", "object": "response", "created_at": 1764857914, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_06e31f12ad9563d9006931983b0fb48193b322341e701cd0c8", "type": "reasoning", "summary": []}, {"id": "msg_06e31f12ad9563d900693198445f4c8193a9041e55bdb16455", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "\\(w(x)>0\\). For the operator that appears naturally in the eigenvalue problem\n\\[\n\\frac{1}{w(x)}L_{\\text{SL}}[y] = \\lambda\\,y,\n\\]\nthe appropriate notion of (formal) self-adjointness is with respect to the weighted inner product\n\\[\n\\langle u, v\\rangle_{L^2_w} \n= \\int_{\\alpha}^{\\beta} u(x)\\,\\overline{v(x)}\\,w(x)\\,dx.\n\\]\n\nDefine\n\\[\nA[y] := \\frac{1}{w(x)}\\,L_{\\text{SL}}[y].\n\\]\nThen\n\\[\n\\langle u, A[v]\\rangle_{L^2_w}\n= \\int_{\\alpha}^{\\beta} u\\,\\overline{A[v]}\\,w\\,dx\n= \\int_{\\alpha}^{\\beta} u\\,\\overline{L_{\\text{SL}}[v]}\\,dx,\n\\]\nand similarly\n\\[\n\\langle A[u], v\\rangle_{L^2_w}\n= \\int_{\\alpha}^{\\beta} v\\,\\overline{L_{\\text{SL}}[u]}\\,dx.\n\\]\nIf we restrict to real-valued functions (or take real parts), the Green identity gives\n\\[\n\\langle u, A[v]\\rangle_{L^2_w} - \\langle A[u], v\\rangle_{L^2_w}\n= \\Bigl[\\,p(x)\\,\\bigl(u(x)v'(x) - u'(x)v(x)\\bigr)\\Bigr]_{\\alpha}^{\\beta}.\n\\]\nThus, whenever the boundary term on the right-hand side vanishes for admissible \\(u,v\\), the operator \\(A=(1/w)L_{\\text{SL}}\\) is formally self-adjoint with respect to \\(\\langle\\cdot,\\cdot\\rangle_{L^2_w}\\).\n\n\\medskip\n\n\\emph{Boundary conditions and vanishing of the boundary term.}\n\nNow impose separated boundary conditions\n\\[\n\\alpha_1 y(\\alpha) + \\alpha_2 y'(\\alpha) = 0, \n\\qquad \n\\beta_1 y(\\beta) + \\beta_2 y'(\\beta) = 0,\n\\]\nwith \\((\\alpha_1,\\alpha_2)\\neq(0,0)\\) and \\((\\beta_1,\\beta_2)\\neq(0,0)\\). Let \\(u\\) and \\(v\\) be any two functions satisfying these same conditions.\n\nAt \\(x=\\alpha\\), we have\n\\[\n\\alpha_1 u(\\alpha) + \\alpha_2 u'(\\alpha) = 0,\n\\qquad\n\\alpha_1 v(\\alpha) + \\alpha_2 v'(\\alpha) = 0.\n\\]\nThere are two cases:\n\n\\smallskip\n\n\\emph{Case 1:} \\(\\alpha_2\\neq 0\\). Then\n\\[\nu'(\\alpha) = -\\frac{\\alpha_1}{\\alpha_2} u(\\alpha),\n\\qquad\nv'(\\alpha) = -\\frac{\\alpha_1}{\\alpha_2} v(\\alpha).\n\\]\nHence\n\\[\nu(\\alpha)v'(\\alpha) - u'(\\alpha)v(\\alpha)\n= u(\\alpha)\\left(-\\frac{\\alpha_1}{\\alpha_2}v(\\alpha)\\right)\n   -\\left(-\\frac{\\alpha_1}{\\alpha_2}u(\\alpha)\\right)v(\\alpha)\n= 0.\n\\]\n\n\\emph{Case 2:} \\(\\alpha_2=0\\). Then \\(\\alpha_1\\neq 0\\), and the boundary condition reduces to\n\\[\nu(\\alpha) = v(\\alpha) = 0.\n\\]\nConsequently,\n\\[\nu(\\alpha)v'(\\alpha) - u'(\\alpha)v(\\alpha) = 0.\n\\]\n\nIn either case the contribution at \\(x=\\alpha\\) vanishes. The same argument applies verbatim at \\(x=\\beta\\) (interchanging \\(\\alpha_1,\\alpha_2\\) with \\(\\beta_1,\\beta_2\\)). Therefore,\n\\[\np(x)\\,\\bigl(u(x)v'(x) - u'(x)v(x)\\bigr)\\Big|_{x=\\alpha}^{x=\\beta} = 0\n\\]\nfor all admissible \\(u\\) and \\(v\\). It follows that\n\\[\n\\langle u, A[v]\\rangle_{L^2_w} = \\langle A[u], v\\rangle_{L^2_w}\n\\]\non the domain of functions satisfying the given separated boundary conditions. Thus the Sturm\u2013Liouville operator \\(A=(1/w)L_{\\text{SL}}\\) is self-adjoint (more precisely: symmetric, and under mild additional conditions, self-adjoint) in the Hilbert space \\(L^2_w([\\alpha,\\beta])\\).\n\n\\medskip\n\n\\emph{(c) Reality of eigenvalues and orthogonality of eigenfunctions.}\n\nConsider the eigenvalue problem\n\\[\nA[y] = \\lambda\\,y,\n\\]\nwith \\(A\\) self-adjoint in \\(L^2_w\\). Let \\(y\\) be a (nonzero) eigenfunction with eigenvalue \\(\\lambda\\).\n\nFirst, take the inner product with \\(y\\):\n\\[\n\\langle A[y], y\\rangle_{L^2_w} = \\lambda\\,\\langle y, y\\rangle_{L^2_w}.\n\\]\nBy self-adjointness,\n\\[\n\\langle A[y], y\\rangle_{L^2_w} = \\langle y, A[y]\\rangle_{L^2_w}\n= \\langle y, \\lambda y\\rangle_{L^2_w}\n= \\overline{\\lambda}\\,\\langle y, y\\rangle_{L^2_w},\n\\]\nwhere the bar denotes complex conjugation. Thus\n\\[\n\\lambda\\,\\langle y, y\\rangle_{L^2_w}\n= \\overline{\\lambda}\\,\\langle y, y\\rangle_{L^2_w}.\n\\]\nSince \\(w(x)>0\\) and \\(y\\not\\equiv 0\\), we have \\(\\langle y,y\\rangle_{L^2_w} > 0\\), so\n\\[\n\\lambda = \\overline{\\lambda},\n\\]\ni.e.\\ every eigenvalue \\(\\lambda\\) is real.\n\nNext, let \\(y_1\\) and \\(y_2\\) be eigenfunctions corresponding to eigenvalues \\(\\lambda_1\\) and \\(\\lambda_2\\), with \\(\\lambda_1\\neq\\lambda_2\\). Then\n\\[\nA[y_1] = \\lambda_1 y_1,\n\\qquad\nA[y_2] = \\lambda_2 y_2.\n\\]\nUsing self-adjointness,\n\\[\n\\langle A[y_1], y_2\\rangle_{L^2_w}\n= \\langle y_1, A[y_2]\\rangle_{L^2_w}.\n\\]\nSubstituting the eigenvalue equations,\n\\[\n\\lambda_1 \\langle y_1, y_2\\rangle_{L^2_w}\n= \\lambda_2 \\langle y_1, y_2\\rangle_{L^2_w}.\n\\]\nHence\n\\[\n(\\lambda_1 - \\lambda_2)\\,\\langle y_1, y_2\\rangle_{L^2_w} = 0.\n\\]\nIf \\(\\lambda_1\\neq\\lambda_2\\), we must have\n\\[\n\\langle y_1, y_2\\rangle_{L^2_w} = 0,\n\\]\ni.e.\\ eigenfunctions corresponding to distinct eigenvalues are orthogonal in \\(L^2_w\\).\n\nThus, by recasting the original second-order equation into Sturm\u2013Liouville form via the integrating factor \\(\\mu(x)\\), we obtain a self-adjoint eigenvalue problem with respect to the weighted inner product \\(\\langle\\cdot,\\cdot\\rangle_{L^2_w}\\), guaranteeing real eigenvalues and orthogonal eigenfunctions. \n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 4984, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 3226, "output_tokens_details": {"reasoning_tokens": 1428}, "total_tokens": 8210}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199165350819082439da35e40a6a1", "custom_id": "example::ordinary-differential-equations::phase-space-dynamics-for-conservative-and-perturbed-systems::3", "response": {"status_code": 200, "request_id": "7dc07bd1262673bb07f3607043831360", "body": {"id": "resp_01b3cde5bb1b73290069319850ac7881978dfc905f2d9d3579", "object": "response", "created_at": 1764857936, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_01b3cde5bb1b73290069319850f7bc8197b60b539a583e78ff", "type": "reasoning", "summary": []}, {"id": "msg_01b3cde5bb1b73290069319852a9b48197add15b25101b5ddd", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "space geometry changes under damping and forcing, and how Poincar\u00e9 maps give a compact, discrete-time description of the long-time behavior of periodically forced systems by encoding convergence to attracting periodic orbits.\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 6913, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 296, "output_tokens_details": {"reasoning_tokens": 239}, "total_tokens": 7209}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199168c188190bb82613ad55511e3", "custom_id": "example::ordinary-differential-equations::phase-space-dynamics-for-conservative-and-perturbed-systems::4", "response": {"status_code": 200, "request_id": "47e804026a61388cd1fb22a594f9f882", "body": {"id": "resp_069db3142e06e28b00693198573bec8195874c6c89955f11d6", "object": "response", "created_at": 1764857943, "status": "incomplete", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": {"reason": "max_output_tokens"}, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_069db3142e06e28b006931985772b881959d12f6f086ff38fd", "type": "reasoning", "summary": []}, {"id": "msg_069db3142e06e28b006931987f8b0c8195b0f0672f23adbffe", "type": "message", "status": "incomplete", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "\\[\n\\frac{\\partial H}{\\partial x}\n= \\frac14 \\cdot 2(x^2-1)\\cdot 2x\n= x(x^2-1)=x^3-x,\n\\qquad\n\\frac{\\partial H}{\\partial y}=y.\n\\]\nTherefore\n\\[\n\\frac{d}{dt}H(x(t),y(t))\n= (x^3-x)x' + y\\,y'\n= (x^3-x)y + y(x-x^3) = 0.\n\\]\nSo \\(H\\) is constant along trajectories.\n\nInterpreting the terms,\n\\[\nH(x,y) = \\frac12 y^2 + V(x),\n\\qquad V(x) = \\frac14(x^2-1)^2,\n\\]\nwe see that \\(\\tfrac12 y^2\\) is the kinetic energy and \\(V(x)\\) is the potential energy. Thus \\(H\\) is the total mechanical energy of a particle moving in the double-well potential \\(V\\).\n\n\\medskip\n\\noindent\\textbf{2. Equilibria, Jacobian, and relation to the potential.}\n\nEquilibria satisfy\n\\[\nx'=0,\\qquad y'=0\n\\quad\\Longrightarrow\\quad\ny=0,\\; x-x^3=0.\n\\]\nHence\n\\[\nx(x^2-1)=0 \\quad\\Longrightarrow\\quad x\\in\\{0,1,-1\\},\n\\]\nso the equilibria are\n\\[\n(x,y)=(0,0),\\quad (1,0),\\quad (-1,0).\n\\]\n\nThe Jacobian of the vector field \\(F(x,y)=(y,\\;x-x^3)\\) is\n\\[\nDF(x,y)\n=\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x}(y) & \\frac{\\partial}{\\partial y}(y)\\\\[4pt]\n\\frac{\\partial}{\\partial x}(x-x^3) & \\frac{\\partial}{\\partial y}(x-x^3)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & 1\\\\[4pt]\n1-3x^2 & 0\n\\end{pmatrix}.\n\\]\nAt an equilibrium \\((x_0,0)\\), the Jacobian is\n\\[\nJ(x_0)=\n\\begin{pmatrix}\n0 & 1\\\\\n1-3x_0^2 & 0\n\\end{pmatrix}.\n\\]\nThe characteristic polynomial is\n\\[\n\\lambda^2 - \\mathrm{tr}(J)\\lambda + \\det(J)\n= \\lambda^2 + \\det(J),\n\\]\nsince \\(\\mathrm{tr}(J)=0\\). Moreover\n\\[\n\\det(J)=0\\cdot 0 - 1(1-3x_0^2) = -(1-3x_0^2),\n\\]\nso the eigenvalues satisfy\n\\[\n\\lambda^2 - (1-3x_0^2)=0\n\\quad\\Longrightarrow\\quad\n\\lambda=\\pm\\sqrt{1-3x_0^2}.\n\\]\n\n\\emph{At \\((0,0)\\):}  \nHere \\(x_0=0\\), so\n\\[\nJ(0,0)=\n\\begin{pmatrix}\n0 & 1\\\\\n1 & 0\n\\end{pmatrix},\n\\qquad\n\\lambda=\\pm1.\n\\]\nThe eigenvalues are real with opposite signs, so \\((0,0)\\) is a \\emph{saddle} in the phase plane.\n\n\\emph{At \\((\\pm1,0)\\):}  \nHere \\(x_0=\\pm1\\), so \\(1-3x_0^2=1-3=-2\\), and\n\\[\nJ(\\pm1,0)=\n\\begin{pmatrix}\n0 & 1\\\\\n-2 & 0\n\\end{pmatrix},\n\\qquad\n\\lambda^2+2=0 \\;\\Longrightarrow\\; \\lambda=\\pm i\\sqrt{2}.\n\\]\nThe eigenvalues are purely imaginary, so the linearization has a center. Because the system is Hamiltonian (it has a nondegenerate conserved quantity \\(H\\)), these equilibria are in fact \\emph{nonlinear centers}: nearby trajectories are closed curves (small oscillations in each well).\n\n\\smallskip\n\\noindent\\emph{Relation to the potential.}\n\nThe equilibria occur at critical points of \\(V\\), that is, at \\(V'(x_0)=0\\). Here\n\\[\nV'(x)=x(x^2-1),\\qquad\nV''(x)=3x^2-1.\n\\]\nThen\n\\[\nV''(0)=-1<0 \\;\\Rightarrow\\; V \\text{ has a local maximum at } x=0,\n\\]\n\\[\nV''(\\pm1)=2>0 \\;\\Rightarrow\\; V \\text{ has local minima at } x=\\pm1.\n\\]\nThus the particle sits at the top of the barrier at \\(x=0\\) (unstable equilibrium, saddle in phase space) and at the bottoms of the wells at \\(x=\\pm1\\) (stable in the 1D mechanical sense, centers in phase space). This is the standard correspondence in 1D Hamiltonian systems: local maxima of \\(V\\) give saddles, local minima of \\(V\\) give centers.\n\n\\medskip\n\\noindent\\textbf{3. Energy levels and qualitative phase portraits.}\n\nWe first compute the energy at the equilibria:\n\\[\nH(x,y)=\\frac12 y^2 + \\frac14(x^2-1)^2.\n\\]\n\n\\emph{At the well minima \\((\\pm1,0)\\):}\n\\[\nH(\\pm1,0)\n= \\frac12\\cdot 0^2 + \\frac14\\,(1-1)^2\n=0.\n\\]\nThis is the minimum possible energy, so \\(E_{\\min}=0\\).\n\n\\emph{At the barrier top \\((0,0)\\):}\n\\[\nH(0,0)=\\frac12\\cdot0^2 + \\frac14\\,(0^2-1)^2=\\frac14.\n\\]\nThus the barrier energy is \\(E_{\\mathrm{bar}}=\\frac14\\).\n\n\\smallskip\n\\noindent\\emph{(a) Energies between the minimum and the barrier.}\n\nTake \\(E\\) with\n\\[\n0<E<\\frac14.\n\\]\nThe level set in the phase plane is defined by\n\\[\n\\frac12 y^2 + \\frac14(x^2-1)^2 = E.\n\\]\nFor such \\(E\\), the condition \\(V(x)\\le E\\) restricts \\(x\\) to two disjoint intervals, one around \\(x=-1\\) and one around \\(x=+1\\), because the barrier at \\(x=0\\) has higher potential \\(V(0)=\\frac14>E\\). Consequently, the level set \\(H(x,y)=E\\) consists of \\emph{two disjoint closed curves}: one surrounding the center at \\((-1,0)\\), the other surrounding the center at \\((1,0)\\). These correspond to periodic oscillations trapped in a single well: the particle oscillates back and forth around one minimum and cannot reach or cross the barrier.\n\n\\smallskip\n\\noindent\\emph{(b) Energies above the barrier.}\n\nNow take \\(E>\\frac14\\). Then\n\\[\nV(x)\\le E\n\\]\nfor all \\(x\\) in a single connected interval \\([-x_{\\max},x_{\\max}]\\) containing the origin, because \\(V(x)\\to\\infty\\) as \\(|x|\\to\\infty\\) but its maximum between the wells is only \\(\\tfrac14<E\\). Hence the level set \\(H(x,y)=E\\) is a \\emph{single} closed curve that passes over the barrier region near \\((0,0)\\). \n\nIn terms of dynamics, the particle moves in a single large oscillation that explores both wells: it repeatedly passes over the barrier, moves to one side, turns around at a turning point, crosses back over the barrier, and so on. In the phase plane, this is a large closed orbit enclosing all three equilibria.\n\n\\medskip\n\\noindent\\textbf{4. The critical energy level and the separatrices.}\n\nThe critical energy is the barrier energy\n\\[\nE_{\\mathrm{bar}} = H(0,0) = \\frac14.\n\\]\nThe corresponding level set\n\\[\nH(x,y)=\\frac14\n\\]\npasses through the saddle \\((0,0)\\) and separates the \u201ctrapped\u201d oscillations from the \u201cover-the-barrier\u201d oscillations.\n\nStarting from\n\\[\n\\frac12 y^2 + \\frac14(x^2-1)^2 = \\frac14,\n\\]\nwe simplify:\n\\[\n\\frac12 y^2 + \\frac14(x^2-1)^2 - \\frac14 = 0\n\\;\\Longleftrightarrow\\;\n\\frac12 y^2 + \\frac14(x^4 - 2x^2 + 1) -\\frac14 =0\n\\]\n\\[\n\\Longleftrightarrow\\;\n\\frac12 y^2 + \\frac14 x^4 - \\frac12 x^2 =0\n\\;\\Longleftrightarrow\\;\ny^2 + \\frac12 x^4 - x^2 =0\n\\]\n\\[\n\\Longleftrightarrow\\;\ny^2 = x^2 - \\frac12 x^4\n= x^2\\Bigl(1-\\frac{x^2}{2}\\B"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 2502, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 8000, "output_tokens_details": {"reasoning_tokens": 5870}, "total_tokens": 10502}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69319916629881908279f7c08e2c2814", "custom_id": "example::partial-differential-equations::first-order-pde-method-of-characteristics::4", "response": {"status_code": 200, "request_id": "84ecb2cb19f9abeac0fd29731ab6b50d", "body": {"id": "resp_0863c02cbc90d744006931988e8b688193906d19c8d5d56666", "object": "response", "created_at": 1764857998, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0863c02cbc90d744006931988eeda881938a422cec73f28cb4", "type": "reasoning", "summary": []}, {"id": "msg_0863c02cbc90d744006931989230348193ae2cc6b966cace08", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "By direct computation, a radially symmetric function $S(x)=f(r)$ has gradient\n\\[\n\\nabla S(x) = f'(r)\\,\\frac{x}{r},\\qquad r=|x|,\n\\]\nso that\n\\[\n|\\nabla S(x)| = |f'(r)|.\n\\]\nThe eikonal equation $|\\nabla S| = 1/c_0$ therefore becomes the ODE\n\\[\n|f'(r)| = \\frac{1}{c_0} = n_0.\n\\]\nChoosing the positive sign to represent an increasing phase with increasing distance from the source (outgoing waves), we take\n\\[\nf'(r) = \\frac{1}{c_0},\n\\]\nwhich integrates to\n\\[\nf(r) = \\frac{r}{c_0} + \\text{constant} = n_0\\,r + \\text{constant}.\n\\]\nUp to an additive constant (which only shifts the phase), we may write\n\\[\nS(x) = \\frac{|x|}{c_0}.\n\\]\n\nThe level sets of $S$,\n\\[\nS(x) = \\text{constant} \\quad\\Longleftrightarrow\\quad |x| = \\text{constant},\n\\]\nare concentric circles centered at the origin. These are the \\emph{wavefronts} (surfaces of constant phase or travel time). The rays, given by the characteristic curves $x(s)$ satisfying $\\dot{x}(s)=\\nabla S(x(s))$, are straight lines passing through the origin:\n\\[\n\\dot{x}(s) \\parallel x(s)\\quad\\Longrightarrow\\quad x(s) = x(0) + s\\,p_0,\n\\]\nwith $p_0$ a constant vector pointing radially outward (for outgoing waves).\n\nThus, in a homogeneous medium:\n\n- Wavefronts are expanding circles centered at the source.\n- Rays are straight radial lines orthogonal to these circles.\n\nThis coincides with the usual physical picture: from a point source in a uniform medium, waves propagate outward in all directions with speed $c_0$, forming circular (in 2D) or spherical (in 3D) wavefronts, and energy travels along straight radial rays.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 4814, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 919, "output_tokens_details": {"reasoning_tokens": 424}, "total_tokens": 5733}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_693199167cc08190a3356d048d315609", "custom_id": "example::partial-differential-equations::elliptic-pdes-method-of-green-function::2", "response": {"status_code": 200, "request_id": "8bff61c33c7f9d5b1636b703af4721be", "body": {"id": "resp_0252dff3983dad2c0069319898f7948195bef9e51b3c2f62cc", "object": "response", "created_at": 1764858008, "status": "incomplete", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": {"reason": "max_output_tokens"}, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0252dff3983dad2c006931989964488195b1f32ae982708ad1", "type": "reasoning", "summary": []}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 5115, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 8000, "output_tokens_details": {"reasoning_tokens": 8000}, "total_tokens": 13115}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6931991694788190934ae3282f556dfe", "custom_id": "example::partial-differential-equations::elliptic-pdes-method-of-green-function::3", "response": {"status_code": 200, "request_id": "626995a87c488e0e956af55dc1502e4a", "body": {"id": "resp_07f0a587d853d4af00693198ce177c8197844e63124ae62efe", "object": "response", "created_at": 1764858062, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_07f0a587d853d4af00693198ce5c588197954cf8812ba24e95", "type": "reasoning", "summary": []}, {"id": "msg_07f0a587d853d4af00693198d7b5488197ba54a2e8c558953b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "\\[\nG(x,\\xi) =\n\\begin{cases}\n\\dfrac{x\\big(1 + hL - h\\xi\\big)}{1 + hL}, & 0 \\le x \\le \\xi \\le L,\\\\[1.2ex]\n\\dfrac{\\xi\\big(1 + hL - h x\\big)}{1 + hL}, & 0 \\le \\xi \\le x \\le L.\n\\end{cases}\n\\]\nEquivalently,\n\\[\nG(x,\\xi) =\n\\begin{cases}\n\\dfrac{x\\big[1 + h(L-\\xi)\\big]}{1 + hL}, & 0 \\le x \\le \\xi \\le L,\\\\[1.2ex]\n\\dfrac{\\xi\\big[1 + h(L-x)\\big]}{1 + hL}, & 0 \\le \\xi \\le x \\le L,\n\\end{cases}\n\\]\nand one easily checks that $G(x,\\xi) = G(\\xi,x)$ (symmetry of the Green function for this self-adjoint problem).\n\n\\medskip\n\n\\textbf{5. Integral representation for the solution.}\n\nGiven $f$, define\n\\[\nu(x) := \\int_0^L G(x,\\xi)\\,f(\\xi)\\,d\\xi.\n\\]\nBecause $-G_{xx}(x,\\xi) = \\delta(x-\\xi)$ in the sense of distributions, we obtain\n\\[\n- u''(x)\n= - \\int_0^L G_{xx}(x,\\xi)\\,f(\\xi)\\,d\\xi\n= \\int_0^L \\delta(x-\\xi)\\,f(\\xi)\\,d\\xi\n= f(x),\n\\]\nso $u$ solves $-u''=f$.\n\nAt the boundaries, the conditions hold because they are imposed pointwise on $G$:\n\n- At $x=0$, $G(0,\\xi)=0$ for all $\\xi$, hence\n  \\[\n  u(0) = \\int_0^L G(0,\\xi)\\,f(\\xi)\\,d\\xi = 0.\n  \\]\n- At $x=L$, we have $G_x(L,\\xi) + h\\,G(L,\\xi)=0$ for all $\\xi$, so\n  \\[\n  u'(L) + h\\,u(L)\n  = \\int_0^L \\big(G_x(L,\\xi) + h\\,G(L,\\xi)\\big)\\,f(\\xi)\\,d\\xi = 0.\n  \\]\n\nThus\n\\[\nu(x) = \\int_0^L G(x,\\xi)\\,f(\\xi)\\,d\\xi\n\\]\nis the desired Green representation of the solution.\n\n\\medskip\n\n\\textbf{6. Limiting cases in the Robin parameter $h$.}\n\n\\emph{(i) Case $h=0$ (Dirichlet--Neumann).}\n\nSetting $h=0$ in the above formula,\n\\[\nG(x,\\xi) =\n\\begin{cases}\n\\dfrac{x(1 + 0)}{1 + 0} = x, & 0 \\le x \\le \\xi \\le L,\\\\[0.8ex]\n\\dfrac{\\xi(1 + 0)}{1 + 0} = \\xi, & 0 \\le \\xi \\le x \\le L.\n\\end{cases}\n\\]\nSo\n\\[\nG(x,\\xi) =\n\\begin{cases}\nx, & x \\le \\xi,\\\\\n\\xi, & \\xi \\le x,\n\\end{cases}\n\\]\nwhich is exactly the Green function for\n\\[\n- u'' = f, \\qquad u(0)=0,\\quad u'(L)=0\n\\]\n(the Dirichlet--Neumann problem).\n\n\\medskip\n\n\\emph{(ii) Limit $h \\to \\infty$ (Dirichlet--Dirichlet).}\n\nFor $h>0$, write\n\\[\nG(x,\\xi) =\n\\begin{cases}\n\\dfrac{x\\big(1 + hL - h\\xi\\big)}{1 + hL}, & x \\le \\xi,\\\\[1.2ex]\n\\dfrac{\\xi\\big(1 + hL - h x\\big)}{1 + hL}, & x \\ge \\xi.\n\\end{cases}\n\\]\nFactor out $h$ from numerator and denominator. For $x \\le \\xi$,\n\\[\nG(x,\\xi)\n= x\\,\\frac{1 + h(L-\\xi)}{1 + hL}\n= x\\,\\frac{h(L-\\xi)\\big(1 + \\tfrac{1}{h(L-\\xi)}\\big)}{hL\\big(1 + \\tfrac{1}{hL}\\big)}\n\\;\\xrightarrow[h\\to\\infty]{}\\; x\\,\\frac{L-\\xi}{L}.\n\\]\nSimilarly, for $x \\ge \\xi$,\n\\[\nG(x,\\xi)\n= \\xi\\,\\frac{1 + h(L-x)}{1 + hL}\n\\xrightarrow[h\\to\\infty]{}\\; \\xi\\,\\frac{L-x}{L}.\n\\]\nTherefore,\n\\[\n\\lim_{h\\to\\infty} G(x,\\xi)\n=\n\\begin{cases}\n\\dfrac{x(L-\\xi)}{L}, & x \\le \\xi,\\\\[0.8ex]\n\\dfrac{\\xi(L-x)}{L}, & x \\ge \\xi,\n\\end{cases}\n\\]\nwhich is precisely the Green function for the Dirichlet--Dirichlet problem\n\\[\n- u'' = f, \\qquad u(0) = 0,\\quad u(L) = 0.\n\\]\n\nPhysically, increasing $h$ strengthens the heat loss at $x=L$ (Newton cooling). In the limit $h\\to\\infty$, the endpoint is forced to remain at the ambient temperature (here taken as $0$), so the Robin boundary condition behaves like a Dirichlet condition $u(L)=0$, as reflected by the limiting Green function.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 4171, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 2796, "output_tokens_details": {"reasoning_tokens": 1453}, "total_tokens": 6967}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69319916d8ac8190a5abd38256c10cd0", "custom_id": "example::partial-differential-equations::waves-in-a-homogeneous-medium-hyperbolic-pde::3", "response": {"status_code": 200, "request_id": "40706f4402eb467b74afe5ff63bd9d5d", "body": {"id": "resp_0b5e2df72c64573c006931976777bc8194985b9624ed0fcdc2", "object": "response", "created_at": 1764857703, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0b5e2df72c64573c0069319767f68c819484dc2499d362dacf", "type": "reasoning", "summary": []}, {"id": "msg_0b5e2df72c64573c006931976b86488194b63c4ceff62faca1", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "$f_n$; modes for which $|f_n|$ is small are weakly excited even if the driving frequency is close to their natural frequency, whereas modes with large $|f_n|$ dominate the steady-state response.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 6370, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 569, "output_tokens_details": {"reasoning_tokens": 505}, "total_tokens": 6939}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69319916b1ac819085f3c42ca7292d47", "custom_id": "example::partial-differential-equations::case-study-burgers-equation::2", "response": {"status_code": 200, "request_id": "8849b5387481577c22ca04f89c9d8e7f", "body": {"id": "resp_007b663f8ecb9f0600693198e168ec8196a8c80df4f7c4675f", "object": "response", "created_at": 1764858081, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_007b663f8ecb9f0600693198e1b9e8819684580235dd09893c", "type": "reasoning", "summary": []}, {"id": "msg_007b663f8ecb9f0600693198ec7cdc819681149dd9e87b1df9", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "hand side is $\\ln\\phi_0(x)-\\ln\\phi_0(0)$, so we obtain\n\\[\n\\ln\\frac{\\phi_0(x)}{\\phi_0(0)}\n= -\\frac{1}{2\\nu}\\int_{0}^{x} u_0(y)\\,dy.\n\\]\nExponentiating gives\n\\[\n\\phi_0(x) = \\phi_0(0)\\,\\exp\\!\\left(-\\frac{1}{2\\nu}\\int_{0}^{x} u_0(y)\\,dy\\right)\n= C \\exp\\!\\left(-\\frac{1}{2\\nu}\\int_{0}^{x} u_0(y)\\,dy\\right),\n\\]\nwhere $C>0$ is an arbitrary constant.\n\nThis constant has no effect on $u$, because\n\\[\nu(t,x) = -2\\nu\\,\\frac{\\phi_x(t,x)}{\\phi(t,x)}\n\\]\nis invariant under the scaling $\\phi \\mapsto C\\phi$ (both numerator and denominator are multiplied by $C$).\n\nSince $\\phi$ satisfies the heat equation with initial data $\\phi_0$, the solution is given by convolution with the heat kernel,\n\\[\n\\phi(t,x) = \\bigl(G_\\nu(t,\\cdot)*\\phi_0\\bigr)(x)\n= \\int_{\\mathbb{R}} G_\\nu(t,x-y)\\,\\phi_0(y)\\,dy,\n\\]\nwhere\n\\[\nG_\\nu(t,x) = \\frac{1}{\\sqrt{4\\pi\\nu t}}\\exp\\!\\left(-\\frac{x^2}{4\\nu t}\\right).\n\\]\nThus\n\\[\nu(t,x) = -2\\nu\\,\\frac{\\partial_x\\phi(t,x)}{\\phi(t,x)}\n= -2\\nu\\,\\partial_x \\ln\\Phi(t,x),\n\\]\nwhere\n\\[\n\\Phi(t,x) := \\int_{\\mathbb{R}} G_\\nu(t,x-y)\\,\\phi_0(y)\\,dy.\n\\]\nEquivalently,\n\\[\nu(t,x)\n= -2\\nu\\,\\frac{\\displaystyle\\int_{\\mathbb{R}} \\partial_x G_\\nu(t,x-y)\\,\\phi_0(y)\\,dy}\n{\\displaystyle\\int_{\\mathbb{R}} G_\\nu(t,x-y)\\,\\phi_0(y)\\,dy}.\n\\]\n\n\\medskip\n\\noindent\\textbf{(c) Explicit example with $\\phi_0(x)=1+e^{-x^2}$.}\n\n\\smallskip\n\\noindent\\emph{Initial velocity.}\nHere\n\\[\n\\phi_0(x) = 1 + e^{-x^2},\\qquad\n\\phi_0'(x) = -2x\\,e^{-x^2},\n\\]\nso\n\\[\nu_0(x) = -2\\nu\\,\\frac{\\phi_0'(x)}{\\phi_0(x)}\n= -2\\nu\\,\\frac{-2x\\,e^{-x^2}}{1+e^{-x^2}}\n= \\frac{4\\nu x\\,e^{-x^2}}{1+e^{-x^2}}.\n\\]\n\n\\smallskip\n\\noindent\\emph{Solving the heat equation for $\\phi$.}\nBy linearity,\n\\[\n\\phi(t,x) = \\bigl(G_\\nu(t,\\cdot)*\\phi_0\\bigr)(x)\n= \\bigl(G_\\nu(t,\\cdot)*1\\bigr)(x)\n + \\bigl(G_\\nu(t,\\cdot)*e^{-(\\cdot)^2}\\bigr)(x).\n\\]\nThe first term is simply $1$, because $G_\\nu$ has total mass $1$. For the second term,\n\\[\n\\bigl(G_\\nu(t,\\cdot)*e^{-(\\cdot)^2}\\bigr)(x)\n= \\int_{-\\infty}^{\\infty}\n\\frac{1}{\\sqrt{4\\pi \\nu t}}\n\\exp\\!\\left(-\\frac{(x-y)^2}{4\\nu t}\\right)e^{-y^2}\\,dy.\n\\]\nCompleting the square in the exponent and evaluating the Gaussian integral (or using the standard formula for the evolution of a Gaussian under the heat equation) yields\n\\[\n\\bigl(G_\\nu(t,\\cdot)*e^{-(\\cdot)^2}\\bigr)(x)\n= \\frac{1}{\\sqrt{1+4\\nu t}}\n\\exp\\!\\left(-\\frac{x^2}{1+4\\nu t}\\right).\n\\]\nHence\n\\[\n\\phi(t,x)\n= 1 + \\frac{1}{\\sqrt{1+4\\nu t}}\n\\exp\\!\\left(-\\frac{x^2}{1+4\\nu t}\\right).\n\\]\n\n\\smallskip\n\\noindent\\emph{Computing $u(t,x)$.}\nDifferentiate $\\phi$ with respect to $x$:\n\\[\n\\phi_x(t,x)\n= \\frac{1}{\\sqrt{1+4\\nu t}}\\,\n\\frac{d}{dx}\\exp\\!\\left(-\\frac{x^2}{1+4\\nu t}\\right)\n= -\\,\\frac{2x}{(1+4\\nu t)^{3/2}}\n\\exp\\!\\left(-\\frac{x^2}{1+4\\nu t}\\right).\n\\]\nTherefore\n\\[\nu(t,x)\n= -2\\nu\\,\\frac{\\phi_x(t,x)}{\\phi(t,x)}\n= \\frac{4\\nu x}{(1+4\\nu t)^{3/2}}\\,\n\\frac{\\exp\\!\\left(-\\frac{x^2}{1+4\\nu t}\\right)}\n{1 + \\dfrac{1}{\\sqrt{1+4\\nu t}}\n\\exp\\!\\left(-\\frac{x^2}{1+4\\nu t}\\right)}.\n\\]\nThis is a smooth, globally defined solution of the viscous Burgers\u2019 equation for all $t>0$.\n\n\\smallskip\n\\noindent\\emph{Qualitative behavior.}\nThe Gaussian component in $\\phi(t,x)$ spreads and decreases in amplitude on the diffusive length scale $\\sqrt{\\nu t}$, and this spreading is inherited by $u(t,x)$ through the logarithmic derivative. The nonlinear term $u\\,u_x$ tends to steepen gradients and transport the profile, while the viscous term $\\nu u_{xx}$ spreads and smooths it. The explicit formula for $u(t,x)$ remains bounded with gradients that decay in time, illustrating how viscosity prevents shock formation and enforces smoothing, in contrast with the inviscid Burgers\u2019 equation, where the same initial velocity profile would typically develop a shock in finite time.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 3565, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 3324, "output_tokens_details": {"reasoning_tokens": 1834}, "total_tokens": 6889}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6931991695108190b53d0b33d02dfd3a", "custom_id": "example::partial-differential-equations::case-study-burgers-equation::3", "response": {"status_code": 200, "request_id": "a07fd21a146c01c77879d6be76089104", "body": {"id": "resp_0e4743369dd00d7d006931976fa0008194bbfbd1b80dfa0537", "object": "response", "created_at": 1764857711, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_0e4743369dd00d7d006931976feaa481949f81da13c6c585bb", "type": "reasoning", "summary": []}, {"id": "msg_0e4743369dd00d7d0069319771effc8194b68e4ae58fa0fdfb", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "\\[\nU(\\xi)\n= \\frac{u_- + u_+}{2}\n  - \\frac{u_- - u_+}{2}\n    \\tanh\\!\\left(\\frac{(u_- - u_+)\\,\\xi}{4\\nu}\\right).\n\\]\n\nTo see this, write\n\\[\nU(\\xi)\n= \\frac{u_- + u_+\\,e^{\\Delta\\xi/(2\\nu)}}{1 + e^{\\Delta\\xi/(2\\nu)}}\n= u_+ + \\frac{u_- - u_+}{1 + e^{\\Delta\\xi/(2\\nu)}}.\n\\]\nSet\n\\[\nz := e^{-\\Delta\\xi/(2\\nu)}.\n\\]\nThen\n\\[\n\\frac{1}{1 + e^{\\Delta\\xi/(2\\nu)}}\n= \\frac{z}{1 + z}.\n\\]\nRecall the identity\n\\[\n\\tanh\\!\\left(\\frac{y}{2}\\right)\n= \\frac{1 - e^{-y}}{1 + e^{-y}},\n\\]\nwhich, with $y = \\Delta\\xi/(2\\nu)$, gives\n\\[\n\\tanh\\!\\left(\\frac{\\Delta\\xi}{4\\nu}\\right)\n= \\frac{1 - e^{-\\Delta\\xi/(2\\nu)}}{1 + e^{-\\Delta\\xi/(2\\nu)}}\n= \\frac{1 - z}{1 + z}.\n\\]\nSolving for $\\dfrac{z}{1+z}$,\n\\[\n\\frac{z}{1+z}\n= \\frac{1 - \\tanh\\!\\left(\\dfrac{\\Delta\\xi}{4\\nu}\\right)}{2}.\n\\]\nHence\n\\[\nU(\\xi)\n= u_+ + (u_- - u_+)\\,\\frac{1}{2}\n   \\Bigl[1 - \\tanh\\!\\Bigl(\\frac{\\Delta\\xi}{4\\nu}\\Bigr)\\Bigr]\n= \\frac{u_- + u_+}{2}\n  - \\frac{\\Delta}{2}\\,\\tanh\\!\\Bigl(\\frac{\\Delta\\xi}{4\\nu}\\Bigr),\n\\]\nand since $\\Delta = u_- - u_+$, we obtain\n\\[\nU(\\xi)\n= \\frac{u_- + u_+}{2}\n  - \\frac{u_- - u_+}{2}\n    \\tanh\\!\\left(\\frac{(u_- - u_+)\\,\\xi}{4\\nu}\\right),\n\\]\nwhich is the claimed explicit traveling wave profile for $u_- > u_+$.\n\n\\medskip\n\n\\noindent\\textbf{(iv) Inviscid limit and Rankine--Hugoniot speed.}\nFor $u_- > u_+$, the function $U(\\xi)$ is a smooth, monotone decreasing transition from $u_-$ (as $\\xi\\to -\\infty$) to $u_+$ (as $\\xi\\to +\\infty$). The transition occurs over a characteristic length scale given by the argument of the hyperbolic tangent,\n\\[\n\\frac{(u_- - u_+)\\,\\xi}{4\\nu} = O(1)\n\\quad\\Longrightarrow\\quad\n|\\xi| = O\\!\\left(\\frac{\\nu}{|u_- - u_+|}\\right).\n\\]\nThus, as $\\nu \\to 0^+$, the thickness of the transition layer shrinks like $O(\\nu)$, and $U(\\xi)$ approaches a discontinuous step function:\n\\[\nU(\\xi) \\to\n\\begin{cases}\nu_-, & \\xi < 0,\\\\[4pt]\nu_+, & \\xi > 0,\n\\end{cases}\n\\]\ni.e., a shock located at $\\xi = 0$ (or, in $(x,t)$ variables, at $x = st$).\n\nThe corresponding solution of the inviscid conservation law\n\\[\nu_t + \\frac{1}{2}(u^2)_x = 0\n\\]\nis a propagating shock joining $u_-$ to $u_+$. The speed $s$ of this shock is given by the Rankine--Hugoniot condition\n\\[\ns = \\frac{f(u_+) - f(u_-)}{u_+ - u_-},\n\\quad f(u) = \\frac{u^2}{2},\n\\]\nwhich yields\n\\[\ns = \\frac{\\tfrac12 u_+^2 - \\tfrac12 u_-^2}{u_+ - u_-}\n= \\frac{u_- + u_+}{2},\n\\]\nexactly the speed obtained from the traveling wave analysis. Thus, in the limit $\\nu\\to 0^+$, the viscous shock profile converges to the entropy-satisfying inviscid shock moving at the Rankine--Hugoniot speed.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 5333, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 1361, "output_tokens_details": {"reasoning_tokens": 274}, "total_tokens": 6694}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69319916d78c8190afe13f446b2d5f48", "custom_id": "example::partial-differential-equations::case-study-burgers-equation::4", "response": {"status_code": 200, "request_id": "24ce7e635ee259e1ec8c05a1d2d3ee48", "body": {"id": "resp_00ecf28e9e45ee8600693198f6df888193acb254076b06e1ab", "object": "response", "created_at": 1764858102, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": 8000, "max_tool_calls": null, "model": "gpt-5.1-2025-11-13", "output": [{"id": "rs_00ecf28e9e45ee8600693198f71f68819391dad4bf8f6831ae", "type": "reasoning", "summary": []}, {"id": "msg_00ecf28e9e45ee86006931990417408193aed69f28b8b22232", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "} and discarding terms that are quadratic in $v$, we obtain\n\\[\nU + v_j^{n+1}\n= U + v_j^n\n- \\frac{\\Delta t}{\\Delta x}\\,U\\,(v_j^n - v_{j-1}^n)\n+ \\nu\\,\\frac{\\Delta t}{\\Delta x^2}\\,\\bigl(v_{j+1}^n - 2v_j^n + v_{j-1}^n\\bigr).\n\\]\nThe constant $U$ cancels from both sides, leaving\n\\[\nv_j^{n+1}\n= v_j^n\n- \\frac{U\\Delta t}{\\Delta x}\\,(v_j^n - v_{j-1}^n)\n+ \\nu\\,\\frac{\\Delta t}{\\Delta x^2}\\,\\bigl(v_{j+1}^n - 2v_j^n + v_{j-1}^n\\bigr).\n\\]\n\nComparing with the given linearized form,\n\\[\nv_j^{n+1} = v_j^n - C\\,(v_j^n - v_{j-1}^n) + \\mu\\,(v_{j+1}^n - 2v_j^n + v_{j-1}^n),\n\\]\nwe can read off\n\\[\nC = \\frac{U\\,\\Delta t}{\\Delta x}, \\qquad\n\\mu = \\frac{\\nu\\,\\Delta t}{\\Delta x^2}.\n\\]\n\n\\medskip\n\n\\noindent\\emph{Rewriting as a three-point stencil.}\nWe expand\n\\begin{align*}\nv_j^{n+1}\n&= v_j^n - C\\,(v_j^n - v_{j-1}^n)\n   + \\mu\\,(v_{j+1}^n - 2v_j^n + v_{j-1}^n) \\\\\n&= v_j^n - C v_j^n + C v_{j-1}^n\n   + \\mu v_{j+1}^n - 2\\mu v_j^n + \\mu v_{j-1}^n \\\\\n&= (C+\\mu)\\,v_{j-1}^n\n   + \\bigl(1 - C - 2\\mu\\bigr)\\,v_j^n\n   + \\mu\\,v_{j+1}^n.\n\\end{align*}\nThus\n\\[\na = C+\\mu,\\qquad b = 1 - C - 2\\mu,\\qquad c = \\mu.\n\\]\nOne readily checks\n\\[\na + b + c = (C+\\mu) + (1 - C - 2\\mu) + \\mu = 1.\n\\]\n\n\\medskip\n\n\\noindent\\emph{Convex-combination stability condition.}\nA sufficient condition for stability in the maximum norm is that\n\\[\na\\ge 0,\\quad b\\ge 0,\\quad c\\ge 0,\\quad a+b+c=1,\n\\]\nso that $v_j^{n+1}$ is a convex combination of neighboring values.\n\nWe already have $a+b+c=1$. The nonnegativity conditions are:\n\\begin{itemize}\n    \\item $c = \\mu \\ge 0$, which holds automatically since $\\nu,\\Delta t,\\Delta x^2>0$;\n    \\item $a = C+\\mu \\ge 0$, which holds automatically since $U>0$;\n    \\item $b = 1 - C - 2\\mu \\ge 0$, which gives the only nontrivial constraint:\n    \\[\n    C + 2\\mu \\le 1.\n    \\]\n\\end{itemize}\nIn terms of the original parameters,\n\\[\nC + 2\\mu\n= \\frac{U\\,\\Delta t}{\\Delta x} + 2\\,\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\n= \\Delta t\\left(\\frac{U}{\\Delta x} + \\frac{2\\nu}{\\Delta x^2}\\right) \\le 1.\n\\]\nThus a sufficient stability condition is\n\\[\n\\boxed{\\;\n\\Delta t \\;\\le\\; \\frac{1}{\\dfrac{U}{\\Delta x} + \\dfrac{2\\nu}{\\Delta x^2}}\n\\;}\n\\]\nas claimed.\n\n\\medskip\n\n\\noindent\\emph{Behavior for small $\\nu$ and small $\\Delta x$.}\n\\begin{itemize}\n    \\item If $\\nu$ is very small, the diffusive term contributes little to the restriction and the condition is dominated by advection:\n    \\[\n    \\Delta t \\lesssim \\frac{\\Delta x}{U}.\n    \\]\n    The time step can then scale linearly with $\\Delta x$ (a typical CFL condition for advection-dominated problems).\n\n    \\item If the grid is very fine (small $\\Delta x$) with fixed $\\nu$, the diffusive term\n    \\[\n    \\frac{2\\nu}{\\Delta x^2}\n    \\]\n    becomes large and dominates the bound. Then\n    \\[\n    \\Delta t \\lesssim \\frac{\\Delta x^2}{2\\nu},\n    \\]\n    which is the classic parabolic time-step restriction: as $\\Delta x$ halves, $\\Delta t$ must be reduced by roughly a factor of $4$ to maintain stability.\n\\end{itemize}\n\n\\medskip\n\n\\noindent\\textbf{(4) Qualitative behavior and dependence on $\\nu$ and $\\Delta x$.}\n\n\\medskip\n\n\\noindent\\emph{(i) Long-time behavior for moderate viscosity.}\nTake $\\nu = 10^{-2}$ and initial data $u_0(x)\\equiv 0$. The left boundary enforces $u(0,t)=1$ and the right boundary enforces $u(1,t)=0$. Over time, the solution is driven from the initial state towards a steady profile $u_\\infty(x)$ that solves the stationary boundary-value problem\n\\[\nu\\,u_x = \\nu\\,u_{xx}, \\qquad 0<x<1,\\qquad u_\\infty(0)=1,\\quad u_\\infty(1)=0.\n\\]\nQualitatively, this steady solution is\n\\begin{itemize}\n    \\item monotone decreasing from $u\\approx 1$ near $x=0$ to $u\\approx 0$ near $x=1$,\n    \\item smooth, with a single transition layer (shock-like region) somewhere between $x=0$ and $x=1$,\n    \\item relatively broad for a moderate viscosity: the gradient is largest in the transition region, whose thickness is of order $\\nu$ (up to factors depending on the precise profile).\n\\end{itemize}\nIn the discrete scheme, $u_j^n$ will relax towards a numerically steady state with a similar smooth, monotone profile. The largest changes from one grid point to the next occur in the same transition region; away from it the solution will be nearly flat (close to $1$ on the left and $0$ on the right).\n\n\\medskip\n\n\\noindent\\emph{(ii) Effect of decreasing $\\nu$ and of refining the grid.}\n\n\\smallskip\n\\noindent\\underline{Decreasing $\\nu$ (fixed grid, stable $\\Delta t$).}\nIf we reduce $\\nu$ by a factor of $10$ while keeping the grid and (stability-respecting) time step the same:\n\\begin{itemize}\n    \\item The physical diffusion becomes weaker, so the continuous steady profile develops a sharper transition layer: the region over which $u$ drops from $1$ to $0$ becomes thinner.\n    \\item On a fixed grid, once the true physical layer becomes thinner than a few mesh cells, the scheme cannot fully resolve it. The numerically computed layer will then be smeared over several grid points, with a thickness controlled more by numerical diffusion (from the upwind advection and discrete diffusion) and grid spacing than by the physical $\\nu$.\n    \\item In this first-order upwind/explicit-diffusion scheme, the main artifact is \\emph{excessive smearing}: the shock-like transition will appear too wide compared to the true solution. Strong oscillatory artifacts (undershoots/overshoots) are less likely here because the scheme is monotone under the convex-combination stability condition derived above.\n\\end{itemize}\n\n\\smallskip\n\\noindent\\underline{Refining the grid $\\Delta x$ (fixed $\\nu$).}\nNow keep $\\nu$ fixed and decrease $\\Delta x$:\n\\begin{itemize}\n    \\item The physical transition layer becomes better resolved: with more grid points across the layer, the discrete profile more closely matches the sharpness of the continuous solution.\n    \\item However, the stability restriction becomes more severe, since for small $\\Delta x$ the term $2\\nu/\\Delta x^2$ dominates. To keep $C+2\\mu\\le 1$, $\\Delta t$ must be reduced roughly like $\\Delta x^2$.\n    \\item If $\\Delta x$ is refined \\emph{without} a corresponding reduction in $\\Delta t$ (so that $C+2\\mu>1$), the convex-combination property is lost. Then one may begin to see numerical instabilities, which can manifest as spurious oscillations, undershoots, or overshoots near the steep gradient, and in the worst case as blow-up of the numerical solution.\n    \\item When the stability condition is respected, refinement typically reduces numerical diffusion, leading to a \\emph{sharper} and more accurate representation of the shock-like transition, with less artificial smearing.\n\\end{itemize}\n\nIn summary, the sharpness and accuracy of the numerical transition layer are governed by both the physical viscosity $\\nu$ and the effective numerical resolution $\\Delta x$ (together with a stable $\\Delta t$). Lower viscosity creates steeper true gradients, which require finer grids (and smaller time steps) to be represented faithfully without excessive numerical smearing or instability.\n\n\\end{solution}\n%%% SOLUTION END %%%"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": "medium", "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 1.0, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 4213, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 4357, "output_tokens_details": {"reasoning_tokens": 2136}, "total_tokens": 8570}, "user": null, "metadata": {}}}, "error": null}
